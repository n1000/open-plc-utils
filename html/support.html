<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Support Function Reference &#8212; open-plc-utils 0.0.4 documentation</title>
    
    <link rel="stylesheet" href="_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '0.0.4',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="top" title="open-plc-utils 0.0.4 documentation" href="open-plc-utils.html" />
    <link rel="next" title="Serial Drivers" href="drivers.html" />
    <link rel="prev" title="Scripting" href="scripting.html" /> 
  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="drivers.html" title="Serial Drivers"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="scripting.html" title="Scripting"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="open-plc-utils.html">open-plc-utils 0.0.4 documentation</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="support-function-reference">
<span id="support-functions"></span><h1>Support Function Reference<a class="headerlink" href="#support-function-reference" title="Permalink to this headline">¶</a></h1>
<div class="section" id="introduction">
<span id="support-intro"></span><h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<p>The <strong class="program">Open Powerline Toolkit</strong> includes many general-purpose or multi-purpose functions that may appear in other Qualcomm Atheros applications or in third party packages. Consequently, we describe them separately and store them in separate folders withing the toolkit.</p>
</div>
<div class="section" id="command-line-functions">
<span id="support-command"></span><h2>Command Line Functions<a class="headerlink" href="#command-line-functions" title="Permalink to this headline">¶</a></h2>
<p>Command line functions are used by all toolkit programs. They are generic functions but we include them in a special section because they collectively co-operate to convert command line options and arguments into appropriate binary representations and provide concise but meaningful feedback when that is not possible.</p>
<div class="section" id="assist">
<span id="support-assist"></span><h3>assist<a class="headerlink" href="#assist" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="c.assist">
void <code class="descname">assist</code><span class="sig-paren">(</span>char const<em>&nbsp;*name</em>, char const<em>&nbsp;*type</em>, const struct _code_<em>&nbsp;list[]</em>, size_t<em>&nbsp;size</em>, FILE<em>&nbsp;*fp</em><span class="sig-paren">)</span><a class="headerlink" href="#c.assist" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>Show why a symbolic <code class="docutils literal"><span class="pre">name</span></code> was rejected by function <a class="reference internal" href="#support-lookup"><span class="std std-ref">lookup</span></a> or similar functions. Argument <code class="docutils literal"><span class="pre">type</span></code> contains a title for the class of names stored in <code class="docutils literal"><span class="pre">list</span></code>. This function prints an error message on file stream <code class="docutils literal"><span class="pre">fp</span></code> showing the program name,  the <code class="docutils literal"><span class="pre">type</span></code> string,  the symbolic <code class="docutils literal"><span class="pre">name</span></code> and all names stored in the <code class="docutils literal"><span class="pre">list</span></code>. The <code class="docutils literal"><span class="pre">_code_</span></code> structure is declared in <a class="reference external" href="types.h.html">types.h</a>. The function is declared in <a class="reference external" href="symbol.h.html">symbol.h</a> and defined in <a class="reference external" href="assist.c.html">assist.c</a>. Function <a class="reference internal" href="#support-expect"><span class="std std-ref">expect</span></a> is used to print list names.</p>
</div>
<div class="section" id="basespec">
<span id="support-basespec"></span><h3>basespec<a class="headerlink" href="#basespec" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="c.basespec">
uint64_t <code class="descname">basespec</code><span class="sig-paren">(</span>char const<em>&nbsp;*string</em>, unsigned<em>&nbsp;base</em>, unsigned<em>&nbsp;size</em><span class="sig-paren">)</span><a class="headerlink" href="#c.basespec" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>Return the unsigned integer equivalent of a numeric <code class="docutils literal"><span class="pre">string</span></code>. Print an error message on <code class="docutils literal"><span class="pre">stderr</span></code> and exit the program with status <code class="docutils literal"><span class="pre">1</span></code> if a syntax error occurs or the result exceeds the capacity of the requested integer <code class="docutils literal"><span class="pre">size</span></code> in bytes. If <code class="docutils literal"><span class="pre">base</span></code> is <code class="docutils literal"><span class="pre">0</span></code>,  numeric values may be expressed in decimal, hexadecimal or binary notation where hexadecimal values start with <code class="docutils literal"><span class="pre">&quot;0x&quot;</span></code> and binary values start with <code class="docutils literal"><span class="pre">&quot;0b&quot;</span></code>. When <code class="docutils literal"><span class="pre">base</span></code> is non-zero, the notation in <code class="docutils literal"><span class="pre">string</span></code> must conform to the corresponding number base rules. Applications should cast the return value to the appropriate data type prevent loss-of-data compiler warnings. This function is typically used to convert and length-check integers entered as command line arguments. The function is declared in <a class="reference external" href="number.h.html">number.h</a> and defined in <a class="reference external" href="basespec.c.html">basespec.c</a>.</p>
<p>Like function <a class="reference internal" href="#support-uintspec"><span class="std std-ref">uintspec</span></a>,  this function both converts and range checks numeric string values,  but the minimum and maximum value are implicit in the <code class="docutils literal"><span class="pre">size</span></code> of the integer. The minimum value is always <code class="docutils literal"><span class="pre">0</span></code> and the maximum value can be computed by  <code class="docutils literal"><span class="pre">((1</span> <span class="pre">&lt;&lt;</span> <span class="pre">size</span> <span class="pre">&lt;&lt;</span> <span class="pre">3)</span> <span class="pre">-</span> <span class="pre">1)</span></code>.</p>
</div>
<div class="section" id="bytespec">
<span id="support-bytespec"></span><h3>bytespec<a class="headerlink" href="#bytespec" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="c.bytespec">
void <code class="descname">bytespec</code><span class="sig-paren">(</span>char const<em>&nbsp;*string</em>, void<em>&nbsp;*memory</em>, size_t<em>&nbsp;extent</em><span class="sig-paren">)</span><a class="headerlink" href="#c.bytespec" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>Encode a <code class="docutils literal"><span class="pre">memory</span></code> region with the binary equivalent of a fixed-length hexadecimal string. Print an error message on stderr and exit the program with status <code class="docutils literal"><span class="pre">1</span></code> if a syntax error occurs or the number of octets does not equal  <code class="docutils literal"><span class="pre">extent</span></code>. Hexadecimal octets may be separated by colons for readability but colons are not required. Empty octets are illegal. The function is declared in <a class="reference external" href="memory.h.html">memory.h</a> and defined in <a class="reference external" href="bytespec.c.html">bytespec.c</a>.</p>
<p>This function is typically used to enter fixed-length data, like hardware addresses and encryption keys, on the command line.</p>
</div>
<div class="section" id="checkfilename">
<span id="support-checkfilename"></span><h3>checkfilename<a class="headerlink" href="#checkfilename" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="c.checkfilename">
bool <code class="descname">checkfilename</code><span class="sig-paren">(</span>char const<em>&nbsp;*filename</em><span class="sig-paren">)</span><a class="headerlink" href="#c.checkfilename" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>Return logical <code class="docutils literal"><span class="pre">true</span></code> if the <code class="docutils literal"><span class="pre">filename</span></code> argument contains only letters, digits, slashes, periods, underscores and hyphens. This function can be used to detect cases where a user accidentally entered an Ethernet address in place of a filename on the command line. Ethernet address strings are, as it happens, also valid filenames. The function is declared in <a class="reference external" href="files.h.html">files.h</a> and defined in <a class="reference external" href="checkfilename.c.html">checkfilename.c</a>.</p>
</div>
<div class="section" id="dataspec">
<span id="support-dataspec"></span><h3>dataspec<a class="headerlink" href="#dataspec" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="c.dataspec">
void <code class="descname">dataspec</code><span class="sig-paren">(</span>char const<em>&nbsp;*string</em>, void<em>&nbsp;*memory</em>, size_t<em>&nbsp;extent</em><span class="sig-paren">)</span><a class="headerlink" href="#c.dataspec" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>Encode a <code class="docutils literal"><span class="pre">memory</span></code> region with the binary equivalent of a variable-length hexadecimal string. Print an error message on stderr and exit the program with the status <code class="docutils literal"><span class="pre">1</span></code> if a syntax error occurs or the number of octets exceeds <code class="docutils literal"><span class="pre">extent</span></code>. The number of octets may, however, be less than <code class="docutils literal"><span class="pre">extent</span></code>. Unlike function <a class="reference internal" href="#support-bytespec"><span class="std std-ref">bytespec</span></a>, hexadecimal octets may not be separated by colons. This function is typically used to enter variable-length data from the command line. The function is declared in <a class="reference external" href="memory.h.html">memory.h</a> and defined in <a class="reference external" href="dataspec.c.html">dataspec.c</a>.</p>
</div>
<div class="section" id="error">
<span id="support-error"></span><h3>error<a class="headerlink" href="#error" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="c.error">
void <code class="descname">error</code><span class="sig-paren">(</span>int<em>&nbsp;exitcode</em>, errno_t<em>&nbsp;number</em>, char const<em>&nbsp;*format</em>, ...<span class="sig-paren">)</span><a class="headerlink" href="#c.error" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>This function works like printf except that printed messages appear on <code class="docutils literal"><span class="pre">stderr</span></code> and are prefixed with the program name and error information. If argument <code class="docutils literal"><span class="pre">errno</span></code> is non-zero then messages are prefixed with the system error description. If argument <code class="docutils literal"><span class="pre">exitcode</span></code> is non-zero then function <code class="docutils literal"><span class="pre">error</span></code> exits the program with value <code class="docutils literal"><span class="pre">exitcode</span></code> after printing the message and does not return to the caller. The function is declared in <a class="reference external" href="error.h.html">error.h</a> and defined in <a class="reference external" href="error.c.html">error.c</a>.</p>
<p>This function is used to print informative error messages on the console and prevent program execution from proceeding when input is invalid or some error condition exists.</p>
</div>
<div class="section" id="expect">
<span id="support-expect"></span><h3>expect<a class="headerlink" href="#expect" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="c.expect">
void <code class="descname">expect</code><span class="sig-paren">(</span>const struct _code_<em>&nbsp;list[]</em>, size_t<em>&nbsp;size</em>, FILE<em>&nbsp;*fp</em><span class="sig-paren">)</span><a class="headerlink" href="#c.expect" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>Display all names in argument <code class="docutils literal"><span class="pre">list</span></code> on file stream <code class="docutils literal"><span class="pre">fp</span></code>. This function is called by runction <a class="reference internal" href="#support-assist"><span class="std std-ref">assist</span></a> to print the list of symbolic names but other function may have use for it. The <code class="docutils literal"><span class="pre">_code_</span></code> structure is declared in <a class="reference external" href="types.h.html">types.h</a>. The function is declared in <a class="reference external" href="symbol.h.html">symbol.h</a> and defined in <a class="reference external" href="expect.c.html">expect.c</a>.</p>
</div>
<div class="section" id="getoptv">
<span id="support-getoptv"></span><h3>getoptv<a class="headerlink" href="#getoptv" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="c.getoptv">
int <code class="descname">getoptv</code><span class="sig-paren">(</span>int<em>&nbsp;argc</em>, char const<em>&nbsp;*argv[]</em>, char const<em>&nbsp;*optv[]</em><span class="sig-paren">)</span><a class="headerlink" href="#c.getoptv" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>A custom version of the POSIX function <code class="docutils literal"><span class="pre">getopt</span></code>. It supports standard global variables <code class="docutils literal"><span class="pre">optind</span></code>, <code class="docutils literal"><span class="pre">opterr</span></code>, <code class="docutils literal"><span class="pre">optopt</span></code> and <code class="docutils literal"><span class="pre">optarg</span></code> and the non-standard variable <code class="docutils literal"><span class="pre">optmin</span></code>. It extracts the program name from <code class="docutils literal"><span class="pre">argv[0]</span></code> and sets global string pointer <code class="docutils literal"><span class="pre">program_name</span></code> for use by functions <code class="docutils literal"><span class="pre">alert</span></code>, <code class="docutils literal"><span class="pre">error</span></code> and others. Options <code class="docutils literal"><span class="pre">-?</span></code> and <code class="docutils literal"><span class="pre">--help</span></code> both display program information on <code class="docutils literal"><span class="pre">stdout</span></code>. Options <code class="docutils literal"><span class="pre">-!</span></code> and <code class="docutils literal"><span class="pre">--version</span></code> both display program version information on <code class="docutils literal"><span class="pre">stdout</span></code>. String vector <code class="docutils literal"><span class="pre">optv</span></code> includes both the standard argument <code class="docutils literal"><span class="pre">optstring</span></code> and usage text found in many programs. The function is declared in <a class="reference external" href="getoptv.h.html">getoptv.h</a> and defined in <a class="reference external" href="getoptv.c.html">getoptv.c</a>.</p>
</div>
<div class="section" id="ipv4spec">
<span id="support-ipv4spec"></span><h3>ipv4spec<a class="headerlink" href="#ipv4spec" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="c.ipv4spec">
size_t <code class="descname">ipv4spec</code><span class="sig-paren">(</span>char const<em>&nbsp;*string</em>, void<em>&nbsp;*memory</em><span class="sig-paren">)</span><a class="headerlink" href="#c.ipv4spec" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>Encode a 4-byte <code class="docutils literal"><span class="pre">memory</span></code> region with an IPv4 dotted-decimal <code class="docutils literal"><span class="pre">string</span></code> and return the number of bytes encoded. Terminate the program with an error message and exitcode of <code class="docutils literal"><span class="pre">1</span></code> on conversion error. The value returned by this function is always <code class="docutils literal"><span class="pre">4</span></code> and memory is always encoded in network byte order. This function is typically used to convert IPv4 strings entered as command line arguments. The function is declared in <a class="reference external" href="memory.h.html">memory.h</a> and defined in <a class="reference external" href="ipv4spec.c.html">ipv4spec.c</a>.</p>
<p>Dotted-decimal format consists of decimal values in the range 0 through 255. Each value represents one octet or 8-bit value. IPv4 addresses require 4 such values separated by one decimal point. This function permits empty octets and leading zeros within octets. For example,  &#8221;...&#8221; is equivalent to &#8220;0.0.0.0&#8221; and &#8220;127.0.000.001&#8221; is equivalent to &#8220;127.0.0.1&#8221;. The second example will encode memory as follows <code class="docutils literal"><span class="pre">{</span> <span class="pre">0x7F,</span> <span class="pre">0x00,</span> <span class="pre">0x00,</span> <span class="pre">0x01</span> <span class="pre">}</span></code> which is in network byte order, or big endian.</p>
</div>
<div class="section" id="ipv6spec">
<span id="support-ipv6spec"></span><h3>ipv6spec<a class="headerlink" href="#ipv6spec" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="c.ipv6spec">
size_t <code class="descname">ipv6spec</code><span class="sig-paren">(</span>char const<em>&nbsp;*string</em>, void<em>&nbsp;*memory</em><span class="sig-paren">)</span><a class="headerlink" href="#c.ipv6spec" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>Encode a 16-byte <code class="docutils literal"><span class="pre">memory</span></code> region with an IPv6 colon-separated hexadecimal quartet <code class="docutils literal"><span class="pre">string</span></code> and return the number of bytes encoded. Terminate the program with an error message and exitcode of <code class="docutils literal"><span class="pre">1</span></code> on conversion error. The value returned by this function is always <code class="docutils literal"><span class="pre">16</span></code> and memory is always encoded in network byte order. This function is typically used to convert IPv6 strings entered as command line arguments. The function is declared in <a class="reference external" href="memory.h.html">memory.h</a> and defined in <a class="reference external" href="ipv6spec.c.html">ipv6spec.c</a>.</p>
<p>Colon-separated hexadecimal quartet notation consists of hexadecimal values in the range 0 through FFFF. Each value represents a quartet or a 32-bit value. IPv6 addresses require 8 quartets separated by one colon. By convention, an empty quartet expands with enough zeros to right-justify the remainder of the address. This function permits multiple empty quartets and leading zeros within quartets. When multiple empty quartets appear, only the right-most occurance expands to zeros. For example,  &#8220;AA12::BB34::CC56::DD78&#8221; is equivalent to &#8220;AA12:0000:BB34:0000:CC56:0000:0000:DD78&#8221; because only the right-most empty field expands. This will encode memory as follows <code class="docutils literal"><span class="pre">{</span> <span class="pre">0xAA,</span> <span class="pre">0x12,</span> <span class="pre">0x00,</span> <span class="pre">0x00,</span> <span class="pre">0xBB,</span> <span class="pre">0x34,</span> <span class="pre">0x00,</span> <span class="pre">0x00,</span> <span class="pre">0xCC,</span> <span class="pre">0x56,</span> <span class="pre">0x00,</span> <span class="pre">0x00,</span> <span class="pre">0x00,</span> <span class="pre">0x00,</span> <span class="pre">0xDD,</span> <span class="pre">0x78</span> <span class="pre">}</span></code> which is in network byte order, or big-endian.</p>
</div>
<div class="section" id="lookup">
<span id="support-lookup"></span><h3>lookup<a class="headerlink" href="#lookup" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="c.lookup">
signed <code class="descname">lookup</code><span class="sig-paren">(</span>char const<em>&nbsp;*name</em>, const struct _code_<em>&nbsp;list[]</em>, size_t<em>&nbsp;size</em><span class="sig-paren">)</span><a class="headerlink" href="#c.lookup" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>Lookup a symbolic <code class="docutils literal"><span class="pre">name</span></code> in a <code class="docutils literal"><span class="pre">list</span></code> and return an associated integer or <code class="docutils literal"><span class="pre">-1</span></code> if the <code class="docutils literal"><span class="pre">name</span></code> does not appear in the <code class="docutils literal"><span class="pre">list</span></code>. A typical use is the translation of symbolic command line arguments to integer codes. For example, some Toolkit programs assign symbolic names to field codes so that users can enter names instead of numbers. This approach becomes more useful as the number of permitted codes increases. The <code class="docutils literal"><span class="pre">_code_</span></code> structure is declared in <a class="reference external" href="types.h.html">types.h</a>. The function is declared in <a class="reference external" href="symbol.h.html">symbol.h</a> and defined in <a class="reference external" href="lookup.c.html">lookup.c</a>.</p>
<p>This function offers two benefits: 1) multiple symbols can translate to one code and 2) names can be changed or new names added without affecting program logic. This function is similar to but different from function <a class="reference internal" href="#support-synonym"><span class="std std-ref">synonym</span></a> which returns a character string instead of an integer.</p>
</div>
<div class="section" id="putoptv">
<span id="support-putoptv"></span><h3>putoptv<a class="headerlink" href="#putoptv" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="c.putoptv">
void <code class="descname">putoptv</code><span class="sig-paren">(</span>char const<em>&nbsp;*optv[]</em><span class="sig-paren">)</span><a class="headerlink" href="#c.putoptv" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>Print program information on <code class="docutils literal"><span class="pre">stdout</span></code>. Program information is stored in string vector <code class="docutils literal"><span class="pre">optv</span></code>. String indexes are defined in file <code class="file docutils literal"><span class="pre">putoptv.h</span></code>. String <code class="docutils literal"><span class="pre">optv[0]</span></code> is the POSIX standard argument <code class="docutils literal"><span class="pre">optstring</span></code>. This function is called by function <code class="docutils literal"><span class="pre">getoptv</span></code> whenever option <code class="docutils literal"><span class="pre">-?</span></code> or <code class="docutils literal"><span class="pre">--help</span></code> is detected on the command line. There is virtually no need to call this function directly. The function is declared in <a class="reference external" href="putoptv.h.html">putoptv.h</a> and defined in <a class="reference external" href="putoptv.c.html">putoptv.c</a>.</p>
</div>
<div class="section" id="synonym">
<span id="support-synonym"></span><h3>synonym<a class="headerlink" href="#synonym" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="c.synonym">
char const *<code class="descname">synonym</code><span class="sig-paren">(</span>char const<em>&nbsp;*string</em>, const struct _term_<em>&nbsp;list[]</em>, size_t<em>&nbsp;size</em><span class="sig-paren">)</span><a class="headerlink" href="#c.synonym" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>Lookup a symbolic <code class="docutils literal"><span class="pre">name</span></code> in a <code class="docutils literal"><span class="pre">list</span></code> and return an associated string or the original <code class="docutils literal"><span class="pre">string</span></code> if the <code class="docutils literal"><span class="pre">name</span></code> does not appear in the <code class="docutils literal"><span class="pre">list</span></code>. A typical use is the translation of symbolic command line arguments to their equivalent numeric strings before encoding them. For example, many Toolkit programs convert the command line argument &#8220;local&#8221; to &#8220;00:B0:52:00:00:01&#8221; before encoding the device MAC address. The <code class="docutils literal"><span class="pre">_term_</span></code> structure is declared in <a class="reference external" href="types.h.html">types.h</a>. The function is declared in <a class="reference external" href="symbol.h.html">symbol.h</a> and defined in <a class="reference external" href="synonym.c.html">synonym.c</a>.</p>
<p>This function is similar to but different from function <a class="reference internal" href="#support-lookup"><span class="std std-ref">lookup</span></a> which returns an integer instead of a character string.</p>
</div>
<div class="section" id="uintspec">
<span id="support-uintspec"></span><h3>uintspec<a class="headerlink" href="#uintspec" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="c.uintspec">
uint64_t <code class="descname">uintspec</code><span class="sig-paren">(</span>char const<em>&nbsp;*string</em>, uint64_t<em>&nbsp;minimum</em>, uint64_t<em>&nbsp;maximum</em><span class="sig-paren">)</span><a class="headerlink" href="#c.uintspec" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>Return the unsigned integer equivalent of a numeric <code class="docutils literal"><span class="pre">string</span></code>. Print an error message on <code class="docutils literal"><span class="pre">stderr</span></code> and exit the program with the value <code class="docutils literal"><span class="pre">1</span></code> when a syntax error occurs or the result exceeds the specified <code class="docutils literal"><span class="pre">minimum</span></code> or <code class="docutils literal"><span class="pre">maximum</span></code> value. Numeric values may be expressed in decimal, hexadecimal or binary notation where hexadecimal values start with <code class="docutils literal"><span class="pre">&quot;0x&quot;</span></code> and binary values start with <code class="docutils literal"><span class="pre">&quot;0b&quot;</span></code>. Applications should cast the return value to the appropriate data type to avoid loss-of-data warnings on some compilers. This function is typically used to convert and range-check integer values entered as command-line arguments. The function is declared in <a class="reference external" href="number.h.html">number.h</a> and defined in <a class="reference external" href="uintspec.c.html">uintspec.c</a>.</p>
</div>
<div class="section" id="version">
<span id="support-version"></span><h3>version<a class="headerlink" href="#version" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="c.version">
void <code class="descname">version</code><span class="sig-paren">(</span>void<span class="sig-paren">)</span><a class="headerlink" href="#c.version" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>Print package and program version information on <code class="docutils literal"><span class="pre">stdout</span></code>. This function is called by function <code class="docutils literal"><span class="pre">getoptv</span></code> whenever option <code class="docutils literal"><span class="pre">-!</span></code> or <code class="docutils literal"><span class="pre">--version</span></code> is detected on the command line. There is no need to call this function directly. The function is declared in <a class="reference external" href="version.h.html">version.h</a> and defined in <a class="reference external" href="version.c.html">version.c</a>. Constants <code class="docutils literal"><span class="pre">PACKAGE</span></code> and <code class="docutils literal"><span class="pre">VERSION</span></code> define the information that is displayed. They are defined in file <a class="reference external" href="version.h.html">version.h</a> and must be maintained by developers.</p>
</div>
</div>
<div class="section" id="ethernet-functions">
<span id="support-ethernet"></span><h2>Ethernet Functions<a class="headerlink" href="#ethernet-functions" title="Permalink to this headline">¶</a></h2>
<p>The Open Powerline Toolkit supports raw Ethernet I/O on several popular operating systems, including <em>Linux</em>,  <em>Mac OS X</em> and Microsoft <em>Windows</em>. Other operating systems will probably be added over time. These functions are found in the <code class="file docutils literal"><span class="pre">ether</span></code> folder.</p>
<p>Each operating system has a different raw Ethernet interface and so some abstraction was needed to support the toolkit for all environments. Our solution was the channel which is implemented like a <code class="docutils literal"><span class="pre">FILE</span></code> pointer but is used like a file descriptor. All toolkit programs, with a few exceptions, perform raw Ethernet I/O by opening a channel, reading and writing to it and then closing it.</p>
<div class="section" id="channel">
<span id="support-channel"></span><h3>channel<a class="headerlink" href="#channel" title="Permalink to this headline">¶</a></h3>
<p>The channel structure contains enough information to perform raw Ethernet I/O in several common runtime environments; however, portions of the structure vary depending on the environment. These differences are appled by compile time constants that include required structure members and exclude others. The common structure members are identified and described below. The others elements are not discussed because they may change.</p>
<div class="highlight-c"><div class="highlight"><pre><span></span><span class="k">typedef</span> <span class="k">struct</span> <span class="n">__packed</span> <span class="n">channel</span>
<span class="p">{</span>
        <span class="kt">signed</span> <span class="n">fd</span><span class="p">;</span>
        <span class="kt">signed</span> <span class="n">ifindex</span><span class="p">;</span>
        <span class="kt">char</span> <span class="k">const</span> <span class="o">*</span> <span class="n">ifname</span><span class="p">;</span>
        <span class="kt">uint8_t</span> <span class="n">peer</span> <span class="p">[</span><span class="n">ETHER_ADDR_LEN</span><span class="p">];</span>
        <span class="kt">uint8_t</span> <span class="n">host</span> <span class="p">[</span><span class="n">ETHER_ADDR_LEN</span><span class="p">];</span>
        <span class="kt">uint16_t</span> <span class="n">type</span><span class="p">;</span>

        <span class="cm">/* ... &lt;operating system dependent data&gt; ... */</span>

        <span class="kt">signed</span> <span class="n">timeout</span><span class="p">;</span>
        <span class="n">flag_t</span> <span class="n">flags</span><span class="p">;</span>
<span class="p">}</span> <span class="n">CHANNEL</span><span class="p">;</span>
</pre></div>
</div>
<dl class="docutils">
<dt><code class="docutils literal"><span class="pre">fd</span></code></dt>
<dd>Socket file descriptor.</dd>
<dt><code class="docutils literal"><span class="pre">ifindex</span></code></dt>
<dd>Ethernet device index. The index only applies when the toolkit is compiled for <strong class="program">LibPcap</strong> or <strong class="program">WinPcap</strong>. This value is the same as that returned in the <code class="docutils literal"><span class="pre">ifr_ifindex</span></code> member of the <code class="docutils literal"><span class="pre">ifreq</span></code> structure available on most operating systems.</dd>
<dt><code class="docutils literal"><span class="pre">ifname</span></code></dt>
<dd>The interface name. On Linux, ethernet names are typically &#8220;eth0&#8221;,  &#8220;eth1&#8221; and so on. On Mac OS X, interface names are &#8220;en0&#8221;,  &#8220;en1&#8221; and so on. This string is the same as that returned by the <code class="docutils literal"><span class="pre">ifr_ifname</span></code> member of the <code class="docutils literal"><span class="pre">ifreq</span></code> structure available on most operating systems.</dd>
<dt><code class="docutils literal"><span class="pre">peer</span></code></dt>
<dd>The Ethernet hardware address of some remote device. It is used to encode the ODA field of outgoing Ethernet frames and format some console messages. It is initialized to the Atheros Local Management Address, <code class="docutils literal"><span class="pre">00:B0:52:00:00:01</span></code> for HomePlug AV applications. Application programs can,  and often do, replace this value at runtime.</dd>
<dt><code class="docutils literal"><span class="pre">host</span></code></dt>
<dd>The Ethernet hardware address of the host computer. It is used to encode the OSA field of outgoing Ethernet frames and format some console messages. This address is initialized to the hardware address assigned to the interface by the host operating system. The value should not change.</dd>
<dt><code class="docutils literal"><span class="pre">type</span></code></dt>
<dd>The Ethernet type/length field. It is used to encode the MTYPE field of outgoing Ethernet frames. The values is initialized to <code class="docutils literal"><span class="pre">0x88E1</span></code> for HomePlug AV application and <code class="docutils literal"><span class="pre">0x887B</span></code> for HomePlug 1.0 application. The value should not change.</dd>
<dt><code class="docutils literal"><span class="pre">timeout</span></code></dt>
<dd>A time interval. On <em>Linux</em> and <em>Mac OS X</em>, it is the maximum time that the application will wait for a device to respond when a response is expected. With <em>LibPcap</em> and <em>WinPcap</em> it the mininum time the application will wait. It is initialized to <code class="docutils literal"><span class="pre">50</span></code> milliseconds which is a reasonable compromise but most toolkit programs allow the user to change this value.</dd>
<dt><code class="docutils literal"><span class="pre">flags</span></code></dt>
<dd>A bitmap where each bit enables a special behavior during channel open or close or packet read or write. Of general interest is the <code class="docutils literal"><span class="pre">CHANNEL_VERBOSE</span></code> bit which prints outgoing and incoming frames on stderr in hexadecimal dump format. The verbose feature is implemented in for all toolkit programs that perform raw Ethernet I/O and is helpful when debugging device behavior.</dd>
</dl>
<p>Since toolkit applications typically communicate with one powerline device at a time, this structure is statically initialized in a stand-alone module that is linked into each application. It is possible to dynamically initialize it, if needed. The structure is declared in <a class="reference external" href="channel.h.html">channel.h</a> and statically defined in <a class="reference external" href="channel.c.html">channel.c</a>.</p>
</div>
<div class="section" id="closechannel">
<span id="support-closechannel"></span><h3>closechannel<a class="headerlink" href="#closechannel" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="c.closechannel">
signed <code class="descname">closechannel</code><span class="sig-paren">(</span>struct channel<em>&nbsp;*channel</em><span class="sig-paren">)</span><a class="headerlink" href="#c.closechannel" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>Close the Ethernet socket associated with a channel and free associated memory and data structures. Return <code class="docutils literal"><span class="pre">0</span></code> on success. Return <code class="docutils literal"><span class="pre">-1</span></code> on failure. This function is declared in <a class="reference external" href="channel.h.html">channel.h</a> and defined in <a class="reference external" href="closechannel.c.html">closechannel.c</a>.</p>
</div>
<div class="section" id="openchannel">
<span id="support-openchannel"></span><h3>openchannel<a class="headerlink" href="#openchannel" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="c.openchannel">
signed <code class="descname">openchannel</code><span class="sig-paren">(</span>struct channel<em>&nbsp;*channel</em>, uint16_t<em>&nbsp;protocol</em><span class="sig-paren">)</span><a class="headerlink" href="#c.openchannel" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>Open an Ethernet socket that supports the specified protocol and associate it with the interface referenced by the <code class="docutils literal"><span class="pre">channel</span></code> structure .name member. Initialize the interface as needed. The <code class="docutils literal"><span class="pre">protocol</span></code> effectively filters incoming frames for the application.</p>
<p>Interface initialization differs significantly from environment to environment. The socket descriptor is stored in the <code class="docutils literal"><span class="pre">channel</span></code> structure .fd member and the interface hardware address is stored in the <code class="docutils literal"><span class="pre">channel</span></code> structure .host member. Return <code class="docutils literal"><span class="pre">0</span></code> on success. Terminate the program with an error message on failure. This function is declared in <a class="reference external" href="channel.h.html">channel.h</a> and defined in <a class="reference external" href="openchannel.c.html">openchannel.c</a>.</p>
</div>
<div class="section" id="readpacket">
<span id="support-readpacket"></span><h3>readpacket<a class="headerlink" href="#readpacket" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="c.readpacket">
signed <code class="descname">readpacket</code><span class="sig-paren">(</span>struct channel<em>&nbsp;*channel</em>, void<em>&nbsp;*packet</em>, signed<em>&nbsp;length</em><span class="sig-paren">)</span><a class="headerlink" href="#c.readpacket" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>Read one Ethernet frame from the specified channel. The frame is written into memory starting at address <code class="docutils literal"><span class="pre">packet</span></code> and is truncated to the specified <code class="docutils literal"><span class="pre">length</span></code>,  if necessary. Return the actual number of bytes read on success. Return <code class="docutils literal"><span class="pre">0</span></code> on timeout. Return <code class="docutils literal"><span class="pre">-1</span></code> on network error. This function behaves like the standard library <code class="docutils literal"><span class="pre">read</span></code> function. The target memory region remains unchanged on timeout or error. This function is declared in <a class="reference external" href="channel.h.html">channel.h</a> and defined in <a class="reference external" href="readpacket.c.html">readpacket.c</a>.</p>
<p>On systems using Berkeley Packet Filters, such as MacOS X, the <code class="docutils literal"><span class="pre">ODA</span></code> field is automatically replaced on transmission to prevent Ethernet address spoofing. This may not be true on other systems but the practice is becoming more common.</p>
</div>
<div class="section" id="sendpacket">
<span id="support-sendpacket"></span><h3>sendpacket<a class="headerlink" href="#sendpacket" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="c.sendpacket">
signed <code class="descname">sendpacket</code><span class="sig-paren">(</span>struct channel<em>&nbsp;*channel</em>, void<em>&nbsp;*packet</em>, signed<em>&nbsp;length</em><span class="sig-paren">)</span><a class="headerlink" href="#c.sendpacket" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>Write one Ethernet frame to the specified channel. The frame is read from memory starting at address <code class="docutils literal"><span class="pre">packet</span></code> and ending at the specified <code class="docutils literal"><span class="pre">length</span></code>. Return the actual number of bytes sent on success. Return <code class="docutils literal"><span class="pre">0</span></code> on timeout. Return <code class="docutils literal"><span class="pre">-1</span></code> on network error. The frame should be properly formatted as an ethernet frame and must be at least 60 bytes long or it will not be sent. This function behaves like the standard library <code class="docutils literal"><span class="pre">write</span></code> function. The source memory region is not modified. This function is declared in <a class="reference external" href="channel.h.html">channel.h</a> and defined in <a class="reference external" href="sendpacket.c.html">sendpacket.c</a>.</p>
</div>
</div>
<div class="section" id="network-functions">
<span id="support-network"></span><h2>Network Functions<a class="headerlink" href="#network-functions" title="Permalink to this headline">¶</a></h2>
<div class="section" id="networkbridges">
<span id="support-networkbridges"></span><h3>NetworkBridges<a class="headerlink" href="#networkbridges" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="c.NetworkBridges">
size_t <code class="descname">NetworkBridges</code><span class="sig-paren">(</span>struct channel<em>&nbsp;*channel</em>, void<em>&nbsp;*memory</em>, size_t<em>&nbsp;extent</em><span class="sig-paren">)</span><a class="headerlink" href="#c.NetworkBridges" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>Search a channel for local powerline devices (bridges) and store their Ethernet hardware in consecutive <code class="docutils literal"><span class="pre">memory</span></code> locations. The memory <code class="docutils literal"><span class="pre">extent</span></code> is specified in bytes. The number of devices found is returned as the function value,  provided enough space is available to store all addressed. Unlike function <a class="reference internal" href="#support-networkdevices"><span class="std std-ref">NetworkDevices</span></a>, the channel <code class="docutils literal"><span class="pre">peer</span></code> address is ignored.</p>
<p>We call local devices &#8220;bridges&#8221; because each serves as an Ethernet-to-Powerline bridge for the local host.</p>
<div class="section" id="enumerating-local-devices">
<h4>Enumerating Local Devices<a class="headerlink" href="#enumerating-local-devices" title="Permalink to this headline">¶</a></h4>
<div class="highlight-c"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&lt;net/if.h&gt;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&quot;../ether/channel.h&quot;</span><span class="cp"></span>

<span class="k">extern</span> <span class="k">struct</span> <span class="n">channel</span> <span class="n">channel</span><span class="p">;</span>
<span class="kt">uint8_t</span> <span class="n">address</span> <span class="p">[</span><span class="mi">255</span><span class="p">][</span><span class="n">ETHER_ADDR_LEN</span><span class="p">];</span>
<span class="kt">size_t</span> <span class="n">bridge</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

<span class="kt">size_t</span> <span class="n">bridges</span> <span class="o">=</span> <span class="n">NetworkBridges</span> <span class="p">(</span><span class="o">&amp;</span><span class="n">channel</span><span class="p">,</span> <span class="n">address</span><span class="p">,</span> <span class="k">sizeof</span> <span class="p">(</span><span class="n">address</span><span class="p">));</span>
<span class="k">while</span> <span class="p">(</span><span class="n">bridge</span> <span class="o">&lt;</span> <span class="n">bridges</span><span class="p">)</span>
<span class="p">{</span>
        <span class="n">binout</span> <span class="p">(</span><span class="n">address</span> <span class="p">[</span><span class="n">bridge</span><span class="p">],</span> <span class="n">ETHER_ADDR_LEN</span><span class="p">,</span> <span class="sc">&#39;:&#39;</span><span class="p">,</span> <span class="n">stdout</span><span class="p">);</span>
        <span class="n">putc</span> <span class="p">(</span><span class="sc">&#39;\n&#39;</span><span class="p">,</span> <span class="n">stdout</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The code segment shown above illustrates how to use function <code class="docutils literal"><span class="pre">NetworkBridges</span></code> to identify all local devices. We do not need to set the <a class="reference internal" href="#support-channel"><span class="std std-ref">channel</span></a> <code class="docutils literal"><span class="pre">peer</span></code> because <code class="docutils literal"><span class="pre">NetworkBridges</span></code> always uses the Atheros <code class="docutils literal"><span class="pre">localcast</span></code> address. Array <code class="docutils literal"><span class="pre">address</span></code> is declared with two dimensions to simplify access to individual addresses on return.</p>
</div>
</div>
<div class="section" id="networkdevices">
<span id="support-networkdevices"></span><h3>NetworkDevices<a class="headerlink" href="#networkdevices" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="c.NetworkDevices">
size_t <code class="descname">NetworkDevices</code><span class="sig-paren">(</span>struct channel<em>&nbsp;*channel</em>, void<em>&nbsp;*memory</em>, size_t<em>&nbsp;extent</em><span class="sig-paren">)</span><a class="headerlink" href="#c.NetworkDevices" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>Query a powerline device, specified by <a class="reference internal" href="#support-channel"><span class="std std-ref">channel</span></a>, for neighboring network devices and store their Ethernet addresses in consecutive <code class="docutils literal"><span class="pre">memory</span></code> locations. The memory <code class="docutils literal"><span class="pre">extent</span></code> is specified in bytes. The number of devices found is returned as the function value, provided sufficient space is available to store all addresses. Unlike function <a class="reference internal" href="#support-networkbridges"><span class="std std-ref">NetworkBridges</span></a>, the channel <code class="docutils literal"><span class="pre">peer</span></code> address is identifies the device to be queried.</p>
<div class="section" id="enumerating-network-devices">
<h4>Enumerating Network Devices<a class="headerlink" href="#enumerating-network-devices" title="Permalink to this headline">¶</a></h4>
<div class="highlight-c"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&lt;net/if.h&gt;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&quot;../ether/channel.h&quot;</span><span class="cp"></span>

<span class="k">extern</span> <span class="k">struct</span> <span class="n">channel</span> <span class="n">channel</span><span class="p">;</span>
<span class="kt">uint8_t</span> <span class="n">address</span> <span class="p">[</span><span class="mi">255</span><span class="p">][</span><span class="n">ETHER_ADDR_LEN</span><span class="p">];</span>
<span class="kt">size_t</span> <span class="n">device</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

<span class="kt">size_t</span> <span class="n">devices</span> <span class="o">=</span> <span class="n">NetworkDevices</span> <span class="p">(</span><span class="o">&amp;</span><span class="n">channel</span><span class="p">,</span> <span class="n">address</span><span class="p">,</span> <span class="k">sizeof</span> <span class="p">(</span><span class="n">address</span><span class="p">));</span>
<span class="k">while</span> <span class="p">(</span><span class="n">device</span> <span class="o">&lt;</span> <span class="n">devices</span><span class="p">)</span>
<span class="p">{</span>
        <span class="n">binout</span> <span class="p">(</span><span class="n">address</span> <span class="p">[</span><span class="n">device</span><span class="p">],</span> <span class="n">ETHER_ADDR_LEN</span><span class="p">,</span> <span class="sc">&#39;:&#39;</span><span class="p">,</span> <span class="n">stdout</span><span class="p">);</span>
        <span class="n">putc</span> <span class="p">(</span><span class="sc">&#39;\n&#39;</span><span class="p">;,</span> <span class="n">stdout</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The code segment shown above illustrates how to use function <code class="docutils literal"><span class="pre">NetworkDevices</span></code> to identify all devices on a specific network. You must set the <a class="reference internal" href="#support-channel"><span class="std std-ref">channel</span></a> <code class="docutils literal"><span class="pre">peer</span></code> address before calling <code class="docutils literal"><span class="pre">NetworkDevices</span></code>. Array <code class="docutils literal"><span class="pre">address</span></code> is declared with two dimensions to simplify access to individual addresses on return. If the <a class="reference internal" href="#support-channel"><span class="std std-ref">channel</span></a> <code class="docutils literal"><span class="pre">peer</span></code> address is not the Ethernet <code class="docutils literal"><span class="pre">broadcast</span></code> or Atheros <code class="docutils literal"><span class="pre">localcast</span></code> address then the first address returned will be the <a class="reference internal" href="#support-channel"><span class="std std-ref">channel</span></a> <code class="docutils literal"><span class="pre">peer</span></code> address.</p>
</div>
</div>
</div>
<div class="section" id="generic-functions">
<span id="support-generic"></span><h2>Generic Functions<a class="headerlink" href="#generic-functions" title="Permalink to this headline">¶</a></h2>
<p>The functions in this chapter are generic and may have application beyond the Open Powerline Toolkit. In some cases, these functions appear in other Atheros or Open Source software packages. In a few cases, the Toolkit may include complementary or supplementary support functions but only use one or two of them. For example, functions <code class="docutils literal"><span class="pre">memincr</span></code> and <code class="docutils literal"><span class="pre">memdecr</span></code> are both included but <code class="docutils literal"><span class="pre">memdecr</span></code> is not used.</p>
<div class="section" id="binout">
<span id="support-binout"></span><h3>binout<a class="headerlink" href="#binout" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="c.binout">
void <code class="descname">binout</code><span class="sig-paren">(</span>void const<em>&nbsp;*memory</em>, size_t<em>&nbsp;extent</em>, char<em>&nbsp;c</em>, char<em>&nbsp;e</em>, FILE<em>&nbsp;*fp</em><span class="sig-paren">)</span><a class="headerlink" href="#c.binout" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>Print a <code class="docutils literal"><span class="pre">memory</span></code> region as a series of binary octets separated by character <code class="docutils literal"><span class="pre">c</span></code> and terminated by character <code class="docutils literal"><span class="pre">e</span></code>. Normally, character <code class="docutils literal"><span class="pre">c</span></code> will be <code class="docutils literal"><span class="pre">BIN_EXTENDER</span></code>, defined in file <a class="reference external" href="number.h.html">number.h</a>, but it could be any character value. Normally, character <code class="docutils literal"><span class="pre">e</span></code> will be a space or newline, but it could be any character value. A typical use might be to print a register in readable format. For example, specifying <code class="docutils literal"><span class="pre">c</span></code> as <code class="docutils literal"><span class="pre">'-'</span></code>, <code class="docutils literal"><span class="pre">e</span></code> as <code class="docutils literal"><span class="pre">';'</span></code> and <code class="docutils literal"><span class="pre">extent</span></code> as <code class="docutils literal"><span class="pre">4</span></code> would produce output looking something like <code class="docutils literal"><span class="pre">&quot;10101010-1111111-00000000-11001100;&quot;</span></code> where each octet is expressed as a binary integer. The function is declared in <a class="reference external" href="memory.h.html">memory.h</a> and defined in <a class="reference external" href="binout.c.html">binout.c</a>.</p>
</div>
<div class="section" id="checksum32">
<span id="support-checksum32"></span><h3>checksum32<a class="headerlink" href="#checksum32" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="c.checksum32">
unint32_t <code class="descname">checksum32</code><span class="sig-paren">(</span>const uint32_t<em>&nbsp;memory[]</em>, size_t<em>&nbsp;extent</em>, uint32_t<em>&nbsp;checksum</em><span class="sig-paren">)</span><a class="headerlink" href="#c.checksum32" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>Return the 32 bit checksum of a <code class="docutils literal"><span class="pre">memory</span></code> region. The checksum is the one&#8217;s complement of the XOR of all 32 bit words in the region. Argument <code class="docutils literal"><span class="pre">extent</span></code> is the region extent in 32 bit words. Argument <code class="docutils literal"><span class="pre">checksum</span></code> is the reference checksum. The function will return the computed checksum when reference <code class="docutils literal"><span class="pre">checksum</span></code> is <code class="docutils literal"><span class="pre">0</span></code> and will return <code class="docutils literal"><span class="pre">0</span></code> if reference <code class="docutils literal"><span class="pre">checksum</span></code> equals the computed checksum. A typical use is to validate PIB and NVM files or compute new checksums when these files are created or modified. The function is declared in <a class="reference external" href="memory.h.html">memory.h</a> and defined in <a class="reference external" href="checksum32.c.html">checksum32.c</a>.</p>
<p>This function is similar to <a class="reference internal" href="#support-checksum-32"><span class="std std-ref">checksum_32</span></a> but is used exclusively by API functions. It may be deprecated at some point in the future.</p>
</div>
<div class="section" id="checksum-32">
<span id="support-checksum-32"></span><h3>checksum_32<a class="headerlink" href="#checksum-32" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="c.checksum_32">
unint32_t <code class="descname">checksum_32</code><span class="sig-paren">(</span>void const<em>&nbsp;*memory</em>, size_t<em>&nbsp;extent</em>, uint32_t<em>&nbsp;checksum</em><span class="sig-paren">)</span><a class="headerlink" href="#c.checksum_32" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>Return the 32 bit checksum of a <code class="docutils literal"><span class="pre">memory</span></code> region. The checksum is the one&#8217;s complement of the XOR of all 32 bit words in the region. The region <code class="docutils literal"><span class="pre">extent</span></code> is specified in bytes but it will be rounded down to the nearest multiple of 4 bytes. Argument <code class="docutils literal"><span class="pre">checksum</span></code> is the reference checksum. The function will return the computed checksum when reference <code class="docutils literal"><span class="pre">checksum</span></code> is <code class="docutils literal"><span class="pre">0</span></code> and will return <code class="docutils literal"><span class="pre">0</span></code> if reference <code class="docutils literal"><span class="pre">checksum</span></code> equals the computed checksum. A typical use is to validate PIB and NVM files or compute new checksums when these files are created or modified. The function is declared in <a class="reference external" href="memory.h.html">memory.h</a> and defined in <a class="reference external" href="checksum_32.c.html">checksum_32.c</a>.</p>
<p>This function is similar to function <a class="reference internal" href="#support-checksum32"><span class="std std-ref">checksum32</span></a> however there is no need to cast <code class="docutils literal"><span class="pre">memory</span></code> to <code class="docutils literal"><span class="pre">uint32_t</span></code> and there is no need to round <code class="docutils literal"><span class="pre">extent</span></code> down to a multiple of 4 bytes before calling the function because both operations are performed internally. Also, there is no unecessary endian manipulation of the checksum. It is the prefered method of computing a checksum.</p>
</div>
<div class="section" id="chrout">
<span id="support-chrout"></span><h3>chrout<a class="headerlink" href="#chrout" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="c.chrout">
void <code class="descname">chrout</code><span class="sig-paren">(</span>void const<em>&nbsp;*memory</em>, size_t<em>&nbsp;extent</em>, char<em>&nbsp;c</em>, char<em>&nbsp;e</em>, FILE<em>&nbsp;*fp</em><span class="sig-paren">)</span><a class="headerlink" href="#c.chrout" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>Print a <code class="docutils literal"><span class="pre">memory</span></code> region as a string of printable ASCII characters terminated by character <code class="docutils literal"><span class="pre">e</span></code>. Character <code class="docutils literal"><span class="pre">c</span></code> is printed in place of non-printable characters. The string is terminated by character <code class="docutils literal"><span class="pre">e</span></code>. Normally, character <code class="docutils literal"><span class="pre">c</span></code> is <code class="docutils literal"><span class="pre">'.'</span></code> but it could be any character value. Normally, character <code class="docutils literal"><span class="pre">e</span></code> is space or newline but it could be any charcter value. A typical use might be to print a memory region that may (or may not) contain an HFID or other printable text. The function is declared in <a class="reference external" href="memory.h.html">memory.h</a> and defined in <a class="reference external" href="chrout.c.html">chrout.c</a>.</p>
</div>
<div class="section" id="decout">
<span id="support-decout"></span><h3>decout<a class="headerlink" href="#decout" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="c.decout">
void <code class="descname">decout</code><span class="sig-paren">(</span>void const<em>&nbsp;*memory</em>, size_t<em>&nbsp;extent</em>, char<em>&nbsp;c</em>, char<em>&nbsp;e</em>, FILE<em>&nbsp;*fp</em><span class="sig-paren">)</span><a class="headerlink" href="#c.decout" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>Print a <code class="docutils literal"><span class="pre">memory</span></code> region as a series of decimal octets separated by character <code class="docutils literal"><span class="pre">c</span></code> and terminated by character <code class="docutils literal"><span class="pre">e</span></code>. Normally, character <code class="docutils literal"><span class="pre">c</span></code> will be <code class="docutils literal"><span class="pre">DEC_EXTENDER</span></code>, defined in file <a class="reference external" href="number.h.html">number.h</a>, but it could be any character value. Normally, character <code class="docutils literal"><span class="pre">e</span></code> will be a space or newline but it could be any character value.  A typical use might be to print an IP address in readable format. For example, specifying <code class="docutils literal"><span class="pre">c</span></code> as <code class="docutils literal"><span class="pre">'.'</span></code>, character <code class="docutils literal"><span class="pre">e</span></code> as <code class="docutils literal"><span class="pre">'/'</span></code> and <code class="docutils literal"><span class="pre">extent</span></code> as <code class="docutils literal"><span class="pre">4</span></code> would produce output looking something like <code class="docutils literal"><span class="pre">&quot;192.168.099.001/&quot;</span></code> where each octet is expressed as a decimal integer. The function is declared in <a class="reference external" href="memory.h.html">memory.h</a> and defined in <a class="reference external" href="decout.c.html">decout.c</a>.</p>
</div>
<div class="section" id="endian">
<span id="support-endian"></span><h3>endian<a class="headerlink" href="#endian" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="c.endian">
void <code class="descname">endian</code><span class="sig-paren">(</span>void<em>&nbsp;*memory</em>, size_t<em>&nbsp;extent</em><span class="sig-paren">)</span><a class="headerlink" href="#c.endian" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>Reverse the byte order of a <code class="docutils literal"><span class="pre">memory</span></code> region. It is a variable extent version of functions like <code class="docutils literal"><span class="pre">__bswap_16</span></code>, <code class="docutils literal"><span class="pre">__bswap_32</span></code> and <code class="docutils literal"><span class="pre">__bswap_64</span></code>. The function is declared in <a class="reference external" href="memory.h.html">memory.h</a> and defined in <a class="reference external" href="endian.c.html">endian.c</a>.</p>
</div>
<div class="section" id="fdchecksum32">
<span id="support-fdchecksum32"></span><h3>fdchecksum32<a class="headerlink" href="#fdchecksum32" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="c.fdchecksum32">
uint32_t <code class="descname">fdchecksum32</code><span class="sig-paren">(</span>int<em>&nbsp;fd</em>, size_t<em>&nbsp;extent</em>, uint32_t<em>&nbsp;checksum</em><span class="sig-paren">)</span><a class="headerlink" href="#c.fdchecksum32" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>Return the 32 bit checksum of a file region starting from the current file position. The checksum is the one&#8217;s complement of the XOR or of all 32 bit words in the region. Argument <code class="docutils literal"><span class="pre">extent</span></code> must be specified in 32 bit words, not bytes. Argument <code class="docutils literal"><span class="pre">checksum</span></code> is the reference checksum. The function will return the computed checksum when reference <code class="docutils literal"><span class="pre">checksum</span></code> is <code class="docutils literal"><span class="pre">0</span></code> and will return <code class="docutils literal"><span class="pre">0</span></code> if reference <code class="docutils literal"><span class="pre">checksum</span></code> equals the computed checksum. A typical use is to validate NVM files header by header or section by section. The function is declared in <a class="reference external" href="memory.h.html">memory.h</a> and defined in <a class="reference external" href="fdchecksum32.c.html">fdchecksum32.c</a>.</p>
</div>
<div class="section" id="fdchecksum-32">
<span id="support-fdchecksum-32"></span><h3>fdchecksum_32<a class="headerlink" href="#fdchecksum-32" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="c.fdchecksum_32">
uint32_t <code class="descname">fdchecksum_32</code><span class="sig-paren">(</span>int<em>&nbsp;fd</em>, size_t<em>&nbsp;extent</em>, uint32_t<em>&nbsp;checksum</em><span class="sig-paren">)</span><a class="headerlink" href="#c.fdchecksum_32" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>Return the 32 bit checksum of a file region starting from the current file position. The checksum is the one&#8217;s complement of the XOR or of all 32 bit words in the region. Argument <code class="docutils literal"><span class="pre">extent</span></code> is specified in bytes but is rounded down to the nearest multiple of 4 bytes. Argument <code class="docutils literal"><span class="pre">checksum</span></code> is the reference checksum. The function will return the computed checksum when reference <code class="docutils literal"><span class="pre">checksum</span></code> is <code class="docutils literal"><span class="pre">0</span></code> and will return <code class="docutils literal"><span class="pre">0</span></code> if reference <code class="docutils literal"><span class="pre">checksum</span></code> equals the computed checksum. A typical use is to validate NVM files header by header or section by section. The function is declared in <a class="reference external" href="memory.h.html">memory.h</a> and defined in <a class="reference external" href="fdchecksum_32.c.html">fdchecksum_32.c</a>.</p>
<p>This function is similar to function <a class="reference internal" href="#support-fdchecksum32"><span class="std std-ref">fdchecksum32</span></a> but there is no need to round <code class="docutils literal"><span class="pre">extent</span></code> down to the nearest multiple of 4 bytes before calling the function because that is done internally. Also, there is no unecessary endian manuipulation of the checksum.</p>
</div>
<div class="section" id="filepart">
<span id="support-filepar"></span><h3>filepart<a class="headerlink" href="#filepart" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="c.filepart">
char const *<code class="descname">filepart</code><span class="sig-paren">(</span>char const<em>&nbsp;*pathname</em><span class="sig-paren">)</span><a class="headerlink" href="#c.filepart" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>Return the address of the filename portion of a <code class="docutils literal"><span class="pre">pathname</span></code> string. The filename portion is everything after the rightmost path separator. If a path separator is not present then the address of the <code class="docutils literal"><span class="pre">pathname</span></code> string is returned. This function is similar to the POSIX <code class="docutils literal"><span class="pre">basename</span></code> function but it returns an empty string whenever the rightmost character is a path separator. The path separator can be either slash (<code class="docutils literal"><span class="pre">'/'</span></code>) or backslash (<code class="docutils literal"><span class="pre">'\\'</span></code>). The function is declared in <a class="reference external" href="files.h.html">files.h</a> and defined in <a class="reference external" href="filepart.c.html">filepart.c</a>.</p>
</div>
<div class="section" id="hexdecode">
<span id="support-hexdecode"></span><h3>hexdecode<a class="headerlink" href="#hexdecode" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="c.hexdecode">
signed <code class="descname">hexdecode</code><span class="sig-paren">(</span>void<em>&nbsp;*memory</em>, size_t<em>&nbsp;extent</em>, char const<em>&nbsp;buffer[]</em>, size_t<em>&nbsp;extent</em><span class="sig-paren">)</span><a class="headerlink" href="#c.hexdecode" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>Decode a <code class="docutils literal"><span class="pre">memory</span></code> region as a string of ASCII hexadecimal digits. Convert memory until the buffer or memory exhausts and return the string extent. Allow three (3) string characters for each memory byte to be decoded. The number of bytes decoded will be the lesser of argument <code class="docutils literal"><span class="pre">extent</span></code> divided by <code class="docutils literal"><span class="pre">3</span></code> or argument <code class="docutils literal"><span class="pre">extent</span></code>. The function is declared in <a class="reference external" href="memory.h.html">memory.h</a> and defined in <a class="reference external" href="hexdecode.c.html">hexdecode.c</a>.</p>
</div>
<div class="section" id="hexdump">
<span id="support-hexdump"></span><h3>hexdump<a class="headerlink" href="#hexdump" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="c.hexdump">
void <code class="descname">hexdump</code><span class="sig-paren">(</span>void const<em>&nbsp;*memory</em>, size_t<em>&nbsp;offset</em>, size_t<em>&nbsp;extent</em>, FILE<em>&nbsp;*fp</em><span class="sig-paren">)</span><a class="headerlink" href="#c.hexdump" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>Print a full or partial <code class="docutils literal"><span class="pre">memory</span></code> region in hexadecimal format showing memory offsets, hexadecimal byte values and ASCII character values. Argument <code class="docutils literal"><span class="pre">memory</span></code> contains some memory region. Argument <code class="docutils literal"><span class="pre">extent</span></code> is the region extent. Argument <code class="docutils literal"><span class="pre">offset</span></code> is the starting display location. Locations <code class="docutils literal"><span class="pre">memory</span></code> [<code class="docutils literal"><span class="pre">offset</span></code>] up to <code class="docutils literal"><span class="pre">memory</span></code> [<code class="docutils literal"><span class="pre">extent</span></code>] are displayed, allowing a partial dump of the memory region. An <code class="docutils literal"><span class="pre">offset</span></code> of <code class="docutils literal"><span class="pre">0</span></code> will display the entire region. The function is declared in <a class="reference external" href="memory.h.html">memory.h</a> and defined in <a class="reference external" href="hexdump.c.html">hexdump.c</a>.</p>
<p>This function is similar to but different from function <a class="reference internal" href="#support-hexview"><span class="std std-ref">hexview</span></a> .</p>
</div>
<div class="section" id="hexencode">
<span id="support-hexencode"></span><h3>hexencode<a class="headerlink" href="#hexencode" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="c.hexencode">
signed <code class="descname">hexencode</code><span class="sig-paren">(</span>void<em>&nbsp;*memory</em>, size_t<em>&nbsp;extent</em>, char const<em>&nbsp;*string</em><span class="sig-paren">)</span><a class="headerlink" href="#c.hexencode" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>Encode a <code class="docutils literal"><span class="pre">memory</span></code> region with the binary equivalent of an ASCII hexadecimal string. Return the number of bytes encoded or <code class="docutils literal"><span class="pre">0</span></code> on error. The value of <code class="docutils literal"><span class="pre">errno</span></code> is set to <code class="docutils literal"><span class="pre">EINVAL</span></code> if the number of bytes encoded is less than <code class="docutils literal"><span class="pre">extent</span></code> or the entire string cannot be converted due to illegal digits or excessive digits. Ignore optional <code class="docutils literal"><span class="pre">HEX_EXTENDER</span></code> characters separating octets in argument <code class="docutils literal"><span class="pre">string</span></code>. Constant <code class="docutils literal"><span class="pre">HEX_EXTENDER</span></code> is defined in file <a class="reference external" href="number.h.html">number.h</a>. The function is declared in <a class="reference external" href="memory.h.html">memory.h</a> and defined in <a class="reference external" href="hexencode.c.html">hexencode.c</a>.</p>
</div>
<div class="section" id="hexin">
<span id="support-hexin"></span><h3>hexin<a class="headerlink" href="#hexin" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="c.hexin">
ssize_t <code class="descname">hexin</code><span class="sig-paren">(</span>void const<em>&nbsp;*memory</em>, size_t<em>&nbsp;extent</em>, FILE<em>&nbsp;*fp</em><span class="sig-paren">)</span><a class="headerlink" href="#c.hexin" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>This function is similar to <a class="reference internal" href="#support-hexencode"><span class="std std-ref">hexencode</span></a> but it reads from file, instead of a string and ignores non-hexadecimal text and comments within the input stream. Incoming text is binary encoded and written to the specified <code class="docutils literal"><span class="pre">memory</span></code> region. The actual number of bytes encoded is returned or <code class="docutils literal"><span class="pre">-1</span></code> on error. See the <a class="reference external" href="efsu.7.html">efsu</a> man page for a thorough explanation of function behavior. The function is declared in <a class="reference external" href="memory.h.html">memory.h</a> and defined in <a class="reference external" href="hexin.c.html">hexin.c</a>.</p>
</div>
<div class="section" id="hexout">
<span id="support-hexout"></span><h3>hexout<a class="headerlink" href="#hexout" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="c.hexout">
void <code class="descname">hexout</code><span class="sig-paren">(</span>void const<em>&nbsp;*memory</em>, size_t<em>&nbsp;extent</em>, char<em>&nbsp;c</em>, char<em>&nbsp;e</em>, FILE<em>&nbsp;*fp</em><span class="sig-paren">)</span><a class="headerlink" href="#c.hexout" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>Print a <code class="docutils literal"><span class="pre">memory</span></code> region as a series of hexdecimal octets separated by character <code class="docutils literal"><span class="pre">c</span></code> and termianted by character <code class="docutils literal"><span class="pre">e</span></code>. Normally, character <code class="docutils literal"><span class="pre">c</span></code> will be <code class="docutils literal"><span class="pre">HEX_EXTENDER</span></code>, defined in file <a class="reference external" href="number.h.html">number.h</a>, but it could be any character value. Normally, character <code class="docutils literal"><span class="pre">e</span></code> will be a space or newline but it could be any character value. A typical use might be to print a MAC or Ethernet address in readable format. For example, specifying <code class="docutils literal"><span class="pre">c</span></code> as <code class="docutils literal"><span class="pre">':'</span></code>, character <code class="docutils literal"><span class="pre">e</span></code> as <code class="docutils literal"><span class="pre">','</span></code> and <code class="docutils literal"><span class="pre">extent</span></code> as <code class="docutils literal"><span class="pre">6</span></code> would produce output looking something like <code class="docutils literal"><span class="pre">&quot;00:B0:52:DA:DA:01,&quot;</span></code> where each octet is expressed as a hexadecimal integer. The function is declared in <a class="reference external" href="memory.h.html">memory.h</a> and defined in <a class="reference external" href="hexout.c.html">hexout.c</a>.</p>
</div>
<div class="section" id="hexstring">
<span id="support-hexstring"></span><h3>hexstring<a class="headerlink" href="#hexstring" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="c.hexstring">
char *<code class="descname">hexstring</code><span class="sig-paren">(</span>char<em>&nbsp;buffer[]</em>, size_t<em>&nbsp;length</em>, void const<em>&nbsp;*memory</em>, size_t<em>&nbsp;extent</em><span class="sig-paren">)</span><a class="headerlink" href="#c.hexstring" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>Convert a <code class="docutils literal"><span class="pre">memory</span></code> region to a <code class="docutils literal"><span class="pre">NUL</span></code> terminated string and return the string address. This function is identical to function <a class="reference internal" href="#support-hexdecode"><span class="std std-ref">hexdecode</span></a> but it return the string address instead of the number of characters decoded. The function is declared in <a class="reference external" href="memory.h.html">memory.h</a> and defined in <a class="reference external" href="hexstring.c.html">hexstring.c</a>.</p>
</div>
<div class="section" id="hexview">
<span id="support-hexview"></span><h3>hexview<a class="headerlink" href="#hexview" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="c.hexview">
void <code class="descname">hexview</code><span class="sig-paren">(</span>void const<em>&nbsp;*memory</em>, size_t<em>&nbsp;offset</em>, size_t<em>&nbsp;extent</em>, FILE<em>&nbsp;*fp</em><span class="sig-paren">)</span><a class="headerlink" href="#c.hexview" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>Print a partial <code class="docutils literal"><span class="pre">memory</span></code> region in hexadecimal format showing memory offsets, hexadecimal byte values and ASCII character values. Argument <code class="docutils literal"><span class="pre">memory</span></code> contains part of a larger memory region, much like a file window. Argument <code class="docutils literal"><span class="pre">extent</span></code> is the window length. Argument <code class="docutils literal"><span class="pre">offset</span></code> is the relative offset of the window within the region. Locations <code class="docutils literal"><span class="pre">memory</span></code> [<code class="docutils literal"><span class="pre">0</span></code>] up to but excluding  <code class="docutils literal"><span class="pre">memory</span></code> [<code class="docutils literal"><span class="pre">extent</span></code>] are displayed as a partial dump, providing a window into the region. The function is declared in <a class="reference external" href="memory.h.html">memory.h</a> and defined in <a class="reference external" href="hexview.c.html">hexview.c</a>.</p>
<p>This function is similar to but different from function <a class="reference internal" href="#support-hexdump"><span class="std std-ref">hexdump</span></a>.</p>
</div>
<div class="section" id="memdecr">
<span id="support-memdecr"></span><h3>memdecr<a class="headerlink" href="#memdecr" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="c.memdecr">
signed <code class="descname">memdecr</code><span class="sig-paren">(</span>void<em>&nbsp;*memory</em>, size_t<em>&nbsp;extent</em><span class="sig-paren">)</span><a class="headerlink" href="#c.memdecr" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>Decrement a multi-byte <code class="docutils literal"><span class="pre">memory</span></code> region. Return <code class="docutils literal"><span class="pre">0</span></code> on success or <code class="docutils literal"><span class="pre">-1</span></code> if all bytes have decremented to <code class="docutils literal"><span class="pre">0x00</span></code>. For example, <code class="docutils literal"><span class="pre">{</span> <span class="pre">0xFF,</span> <span class="pre">0xFF,</span> <span class="pre">0xFF</span> <span class="pre">}</span></code> decrements to <code class="docutils literal"><span class="pre">{</span> <span class="pre">0xFF,</span> <span class="pre">0xFF,</span> <span class="pre">0xFE</span> <span class="pre">}</span></code> and <code class="docutils literal"><span class="pre">{</span> <span class="pre">0xFF,</span> <span class="pre">0x00,</span> <span class="pre">0x00</span> <span class="pre">}</span></code> decrements to <code class="docutils literal"><span class="pre">{</span> <span class="pre">0xFE,</span> <span class="pre">0xFF,</span> <span class="pre">0xFF</span> <span class="pre">}</span></code>. A typical use is to iterate through a range if IP or MAC address values. The function is declared in <a class="reference external" href="memory.h.html">memory.h</a> and defined in <a class="reference external" href="memdecr.c.html">memdecr.c</a>.</p>
</div>
<div class="section" id="memincr">
<span id="support-memincr"></span><h3>memincr<a class="headerlink" href="#memincr" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="c.memincr">
signed <code class="descname">memincr</code><span class="sig-paren">(</span>void<em>&nbsp;*memory</em>, size_t<em>&nbsp;extent</em><span class="sig-paren">)</span><a class="headerlink" href="#c.memincr" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>Increment a multi-byte <code class="docutils literal"><span class="pre">memory</span></code> region. Return <code class="docutils literal"><span class="pre">0</span></code> on success or <code class="docutils literal"><span class="pre">-1</span></code> once all bytes have been incremented to <code class="docutils literal"><span class="pre">0xFF</span></code>. For example <code class="docutils literal"><span class="pre">{</span> <span class="pre">0x00,</span> <span class="pre">0x00,</span> <span class="pre">0x00</span> <span class="pre">}</span></code> increments to <code class="docutils literal"><span class="pre">{</span> <span class="pre">0x00,</span> <span class="pre">0x00,</span> <span class="pre">0x01</span> <span class="pre">}</span></code> and <code class="docutils literal"><span class="pre">{</span> <span class="pre">0x00,</span> <span class="pre">0xFF,</span> <span class="pre">0xFF</span> <span class="pre">}</span></code> increments to <code class="docutils literal"><span class="pre">{</span> <span class="pre">0x01,</span> <span class="pre">0x00,</span> <span class="pre">0x00</span> <span class="pre">}</span></code>. A typical use is to iterate through a range of IP or MAC address values. The function is declared in <a class="reference external" href="memory.h.html">memory.h</a> and defined in <a class="reference external" href="memincr.c.html">memincr.c</a>.</p>
</div>
<div class="section" id="memout">
<span id="support-memout"></span><h3>memout<a class="headerlink" href="#memout" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="c.memout">
void <code class="descname">memout</code><span class="sig-paren">(</span>void const<em>&nbsp;*memory</em>, size_t<em>&nbsp;extent</em>, char const<em>&nbsp;*format</em>, unsigned<em>&nbsp;group</em>, signed<em>&nbsp;c</em>, FILE<em>&nbsp;*fp</em><span class="sig-paren">)</span><a class="headerlink" href="#c.memout" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>Print a <code class="docutils literal"><span class="pre">memory</span></code> region as a series of octet groups wach separated by character <code class="docutils literal"><span class="pre">c</span></code>. The <code class="docutils literal"><span class="pre">group</span></code> argument specifies the number of octets per group. The <code class="docutils literal"><span class="pre">format</span></code> argument determines how each octet is displayed. Normally, character <code class="docutils literal"><span class="pre">c</span></code> will be one of <code class="docutils literal"><span class="pre">BIN_EXTENDER</span></code>, <code class="docutils literal"><span class="pre">DEC_EXTENDER</span></code> or <code class="docutils literal"><span class="pre">HEX_EXTENDER</span></code> as defined in file <a class="reference external" href="number.h.html">number.h</a>, but it could be any character value. The function is declared in <a class="reference external" href="memory.h.html">memory.h</a> and defined in <a class="reference external" href="memout.c.html">memout.c</a>.</p>
</div>
<div class="section" id="memswap">
<span id="support-memswap"></span><h3>memswap<a class="headerlink" href="#memswap" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="c.memswap">
void <code class="descname">memswap</code><span class="sig-paren">(</span>void<em>&nbsp;*buffer1</em>, void<em>&nbsp;*buffer2</em>, size_t<em>&nbsp;length</em><span class="sig-paren">)</span><a class="headerlink" href="#c.memswap" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>Exchange the contents of one buffer with that of another. No provision is made for buffer overlap. No value is returned. A typical use might be to exchange source and destination addresses in an ethernet packet. The function is declared in <a class="reference external" href="memory.h.html">memory.h</a> and defined in <a class="reference external" href="memswap.c.html">memswap.c</a>.</p>
</div>
<div class="section" id="strdecr">
<span id="support-strdecr"></span><h3>strdecr<a class="headerlink" href="#strdecr" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="c.strdecr">
signed <code class="descname">strdecr</code><span class="sig-paren">(</span>void<em>&nbsp;*memory</em>, size_t<em>&nbsp;extent</em>, byte<em>&nbsp;min</em>, byte<em>&nbsp;max</em><span class="sig-paren">)</span><a class="headerlink" href="#c.strdecr" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>Decrement a multi-byte <code class="docutils literal"><span class="pre">memory</span></code> region using only ASCII character values in the range <code class="docutils literal"><span class="pre">min</span></code> through <code class="docutils literal"><span class="pre">max</span></code>. Return <code class="docutils literal"><span class="pre">0</span></code> on success or <code class="docutils literal"><span class="pre">-1</span></code> once all characters have been decremented to the value of argument <code class="docutils literal"><span class="pre">min</span></code>. For example,  if argument <code class="docutils literal"><span class="pre">min</span></code> is <code class="docutils literal"><span class="pre">'A'</span></code> and argument <code class="docutils literal"><span class="pre">max</span></code> is <code class="docutils literal"><span class="pre">'Z'</span></code> then <code class="docutils literal"><span class="pre">{</span> <span class="pre">'A',</span> <span class="pre">'B',</span> <span class="pre">'C'</span> <span class="pre">}</span></code> decrements to <code class="docutils literal"><span class="pre">{</span> <span class="pre">'A',</span> <span class="pre">'B',</span> <span class="pre">'B'</span> <span class="pre">}</span></code> and <code class="docutils literal"><span class="pre">{</span> <span class="pre">'B',</span> <span class="pre">'Z',</span> <span class="pre">'Z'</span> <span class="pre">}</span></code> decrements to <code class="docutils literal"><span class="pre">{</span> <span class="pre">'A',</span> <span class="pre">'A',</span> <span class="pre">'A'</span> <span class="pre">}</span></code>. A typical use is to generate a sequence of distinct character strings to seed encryption key functions. The function is declared in <a class="reference external" href="memory.h.html">memory.h</a> and defined in <a class="reference external" href="strdecr.c.html">strdecr.c</a>.</p>
</div>
<div class="section" id="strfbits">
<span id="support-strfbits"></span><h3>strfbits<a class="headerlink" href="#strfbits" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="c.strfbits">
size_t <code class="descname">strfbits</code><span class="sig-paren">(</span>char const<em>&nbsp;buffer[]</em>, size_t<em>&nbsp;length</em>, char const<em>&nbsp;*operands[]</em>, char const<em>&nbsp;*operator</em>, unsigned<em>&nbsp;flagword</em><span class="sig-paren">)</span><a class="headerlink" href="#c.strfbits" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>Encode a <code class="docutils literal"><span class="pre">buffer</span></code> with an enumerated list of the <code class="docutils literal"><span class="pre">operands</span></code> associated with the corresponding bits in <code class="docutils literal"><span class="pre">flagword</span></code>. separate enumerated <code class="docutils literal"><span class="pre">operands</span></code> with an <code class="docutils literal"><span class="pre">operator</span></code> string. For example, given <code class="docutils literal"><span class="pre">char</span> <span class="pre">const</span> <span class="pre">*operands</span> <span class="pre">[]</span> <span class="pre">=</span> <span class="pre">{</span> <span class="pre">&quot;loop&quot;,</span> <span class="pre">&quot;wait&quot;,</span>&#160; <span class="pre">&quot;busy&quot;</span> <span class="pre">}</span></code> and <code class="docutils literal"><span class="pre">unsigned</span> <span class="pre">flagword</span> <span class="pre">=</span> <span class="pre">0x05</span></code> then <code class="docutils literal"><span class="pre">strfbits</span> <span class="pre">(buffer,</span>&#160; <span class="pre">length,</span> <span class="pre">operands,</span> <span class="pre">&quot;|&quot;,</span> <span class="pre">flagword)</span></code> would encode buffer with <code class="docutils literal"><span class="pre">&quot;loop|busy&quot;</span></code>. Observe that each bit set in <code class="docutils literal"><span class="pre">flagword</span></code> appears in <code class="docutils literal"><span class="pre">buffer</span></code> as the corresponding string from <code class="docutils literal"><span class="pre">operands</span></code>. A typical application for this function is the enumeration of flagword states. The function is declared in <a class="reference external" href="format.h.html">format.h</a> and defined in <a class="reference external" href="strfbits.c.html">strfbits.c</a>.</p>
</div>
<div class="section" id="strincr">
<span id="support-strincr"></span><h3>strincr<a class="headerlink" href="#strincr" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="c.strincr">
signed <code class="descname">strincr</code><span class="sig-paren">(</span>void<em>&nbsp;*memory</em>, size_t<em>&nbsp;extent</em>, byte<em>&nbsp;min</em>, byte<em>&nbsp;max</em><span class="sig-paren">)</span><a class="headerlink" href="#c.strincr" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>Increment a multi-byte <code class="docutils literal"><span class="pre">memory</span></code> region using only ASCII character values in the range <code class="docutils literal"><span class="pre">min</span></code> through <code class="docutils literal"><span class="pre">max</span></code>. Return <code class="docutils literal"><span class="pre">0</span></code> on success or <code class="docutils literal"><span class="pre">-1</span></code> once all characters have been incremented to the value of argument <code class="docutils literal"><span class="pre">max</span></code>.  For example,  if argument <code class="docutils literal"><span class="pre">min</span></code> is <code class="docutils literal"><span class="pre">'A'</span></code> and argument <code class="docutils literal"><span class="pre">max</span></code> is <code class="docutils literal"><span class="pre">'Z'</span></code> then <code class="docutils literal"><span class="pre">{</span> <span class="pre">'A',</span> <span class="pre">'B',</span> <span class="pre">'C'</span> <span class="pre">}</span></code> increments to <code class="docutils literal"><span class="pre">{</span> <span class="pre">'A',</span> <span class="pre">'B',</span> <span class="pre">'D'</span> <span class="pre">}</span></code> and <code class="docutils literal"><span class="pre">{</span> <span class="pre">'A',</span> <span class="pre">'Z',</span> <span class="pre">'Z'</span> <span class="pre">}</span></code> increments to <code class="docutils literal"><span class="pre">{</span> <span class="pre">'B',</span> <span class="pre">'A',</span> <span class="pre">'A'</span> <span class="pre">}</span></code>. A typical use is to generate a sequence of distinct character strings to seed encryption key functions. The function is declared in <a class="reference external" href="memory.h.html">memory.h</a> and defined in <a class="reference external" href="strincr.c.html">strincr.c</a>.</p>
</div>
<div class="section" id="todigit">
<span id="support-todigit"></span><h3>todigit<a class="headerlink" href="#todigit" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="c.todigit">
unsigned <code class="descname">todigit</code><span class="sig-paren">(</span>unsigned<em>&nbsp;c</em><span class="sig-paren">)</span><a class="headerlink" href="#c.todigit" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>Return the integer value of character <code class="docutils literal"><span class="pre">c</span></code> interpreted as digit in the base 36 number system. It is called by many encode functions to support number base conversion. If the value of <code class="docutils literal"><span class="pre">c</span></code> is <code class="docutils literal"><span class="pre">'0'</span></code> through <code class="docutils literal"><span class="pre">'9'</span></code> then integer <code class="docutils literal"><span class="pre">0</span></code> through <code class="docutils literal"><span class="pre">9</span></code> is returned.  If the value of <code class="docutils literal"><span class="pre">c</span></code> is <code class="docutils literal"><span class="pre">'A'</span></code> through <code class="docutils literal"><span class="pre">'Z'</span></code> or <code class="docutils literal"><span class="pre">'a'</span></code> through <code class="docutils literal"><span class="pre">'z'</span></code> then integer <code class="docutils literal"><span class="pre">10</span></code> through <code class="docutils literal"><span class="pre">35</span></code> is returned. The function is declared in <a class="reference external" href="number.h.html">number.h</a> and defined in <a class="reference external" href="todigit.c.html">todigit.c</a>.</p>
</div>
<div class="section" id="typename">
<span id="support-typename"></span><h3>typename<a class="headerlink" href="#typename" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="c.typename">
char const *<code class="descname">typename</code><span class="sig-paren">(</span>const struct _type_<em>&nbsp;list[]</em>, size_t<em>&nbsp;size</em>, type_t<em>&nbsp;type</em>, char const<em>&nbsp;*name</em><span class="sig-paren">)</span><a class="headerlink" href="#c.typename" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>Return the name associated with a message <code class="docutils literal"><span class="pre">type</span></code> by searching a list arranged in ascending order by message type. Return argument <code class="docutils literal"><span class="pre">name</span></code> as the function value if the message <code class="docutils literal"><span class="pre">type</span></code> is not present in the <code class="docutils literal"><span class="pre">list</span></code>. Data types <code class="docutils literal"><span class="pre">struct</span> <span class="pre">_type_</span></code> and <code class="docutils literal"><span class="pre">type_t</span></code> are defined in file <a class="reference external" href="types.h.html">types.h</a>. A typical use might be to return the name of message based on the message type. The function is declared in <a class="reference external" href="symbol.h.html">symbol.h</a> and defined in <a class="reference external" href="typename.c.html">typename.c</a>.</p>
</div>
</div>
<div class="section" id="message-debug-functions">
<span id="support-message"></span><h2>Message Debug Functions<a class="headerlink" href="#message-debug-functions" title="Permalink to this headline">¶</a></h2>
<p>Message debug functions are not needed for proper toolkit operation but they can be useful during development, debugging and testing phases of product development. They are specific to HomePlug AV messages only.</p>
<div class="section" id="mmecode">
<span id="support-mmecode"></span><h3>MMECode<a class="headerlink" href="#mmecode" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="c.MMECode">
char const *<code class="descname">MMECode</code><span class="sig-paren">(</span>uint16_t<em>&nbsp;MMTYPE</em>, uint8_t<em>&nbsp;MSTATUS</em><span class="sig-paren">)</span><a class="headerlink" href="#c.MMECode" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>Return text that explains the status code for a given Atheros vendor-specific management message. Argument <code class="docutils literal"><span class="pre">MMTYPE</span></code> is an unsigned integer in the range <code class="docutils literal"><span class="pre">0xA000</span></code> through <code class="docutils literal"><span class="pre">0xAFFF</span></code> and must exactly match the <code class="docutils literal"><span class="pre">MMTYPE</span></code> of the message returning the status code. For example, the <code class="docutils literal"><span class="pre">CNF</span></code> variant of a message is currently the only variant that has an <code class="docutils literal"><span class="pre">MSTATUS</span></code> field and so other variants return a default string. The function is declared in <a class="reference external" href="mme.h.html">mme.h</a> and defined in <a class="reference external" href="MMECode.c.html">MMECode.c</a>.</p>
<p>Inclusion of this function can increase application size by 3kb because the text associated with all Atheros vendor-specific management messages and errors are included whether needed or not. Conditional compilation statements are provided internally to suppress the full table with a terse substitute.</p>
<p>Although the <strong class="program">Bootloader</strong> and firmware share some common Vendor Specific Management Messages, the two programs may return different codes for a given message and error condition. Where there are conflicts, Bootloader codes take precedence over firmware codes because it is unlikely that users will .issue the same messages to a device running firmware.</p>
</div>
<div class="section" id="mmemode">
<span id="support-mmemode"></span><h3>MMEMode<a class="headerlink" href="#mmemode" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="c.MMEMode">
char const *<code class="descname">MMEMode</code><span class="sig-paren">(</span>uint16_t<em>&nbsp;MMTYPE</em><span class="sig-paren">)</span><a class="headerlink" href="#c.MMEMode" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>Return the mode of a given management message type as a string. The mode is determined by the two least significant bits of argument  <code class="docutils literal"><span class="pre">MMTYPE</span></code>. The mode string will be one of &#8220;REQ&#8221;, &#8220;CNF&#8221;,  &#8220;IND&#8221; or &#8220;RSP&#8221;. The function is declared in <a class="reference external" href="ihp.h.html">ihp.h</a> and defined in <a class="reference external" href="MMEMode.c.html">MMEMode.c</a>.</p>
<p>Most management messages have a request and a confirmation variant while a few have an indication and a response variant. Requests originate from the host and are acknolwedged by a confirmation from the device. Indications originate from a device and are acknowledged by a response from the host.</p>
</div>
<div class="section" id="mmename">
<span id="support-mmename"></span><h3>MMEName<a class="headerlink" href="#mmename" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="c.MMEName">
char const *<code class="descname">MMEName</code><span class="sig-paren">(</span>uint16_t<em>&nbsp;MMTYPE</em><span class="sig-paren">)</span><a class="headerlink" href="#c.MMEName" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>Return the name associated with a given management message type. The name is the mnemonic used to distinguish one message type from another in the <em>HomePlug AV Specification</em> or Atheros <em>Firwmare Technical Reference Manual</em>. Argument <code class="docutils literal"><span class="pre">MMTYPE</span></code> is an unsigned integer in the range <code class="docutils literal"><span class="pre">0x0000</span></code> through <code class="docutils literal"><span class="pre">0xAFFF</span></code>. The request, confirmation, indication and response variants of a management message will all return the same message name. The function is declared in <a class="reference external" href="mme.h.html">mme.h</a> and defined in <a class="reference external" href="MMEName.c.html">MMEName.c</a>.</p>
</div>
<div class="section" id="mmepeek">
<span id="support-mmepeek"></span><h3>MMEPeek<a class="headerlink" href="#mmepeek" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="c.MMEPeek">
void <code class="descname">MMEPeek</code><span class="sig-paren">(</span>void const<em>&nbsp;*memory</em>, size_t<em>&nbsp;extent</em>, FILE<em>&nbsp;*fp</em><span class="sig-paren">)</span><a class="headerlink" href="#c.MMEPeek" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>Prints an Atheros vendor-specific management message to stream <code class="docutils literal"><span class="pre">fp</span></code> in human readable format. Argument <code class="docutils literal"><span class="pre">buffer</span></code> is the message address and argument <code class="docutils literal"><span class="pre">extent</span></code> is the message extent in bytes. Output consists of a formatted header showing decoded header. The function is declared in <a class="reference external" href="mme.h.html">mme.h</a> and defined in <a class="reference external" href="MMEPeek.c.html">MMEPeek.c</a>.</p>
</div>
</div>
<div class="section" id="key-generation-functions">
<span id="support-key"></span><h2>Key Generation Functions<a class="headerlink" href="#key-generation-functions" title="Permalink to this headline">¶</a></h2>
<p>Atheros applications use the SHA256 algorithm to compute unique HomePlug AV keys, including the Device Access Key (DAK), Network Membership Key (NMK) and Network Identifier (NID). The SHA256 algorithm is seeded, salted and rehashed differently for each type of HomePlug AV key. A different function is used to compute each type of HomePlug AV key but all of them call the SHA256 functions. The SHA256 algorithm returns a <code class="docutils literal"><span class="pre">256</span></code> bit (<code class="docutils literal"><span class="pre">32</span></code> byte) digest but only the upper <code class="docutils literal"><span class="pre">128</span></code> bits (<code class="docutils literal"><span class="pre">16</span></code> bytes) are used for HomePlug AV keys.</p>
<div class="section" id="sha256-digest-computation">
<h3>SHA256 Digest Computation<a class="headerlink" href="#sha256-digest-computation" title="Permalink to this headline">¶</a></h3>
<p>The following code example illustrates how to generate, rehash and print an SHA256 digest, or key, from a user-defined seed string and salt string. This logic is typical of that used to generate HomePlug AV compliant keys. See the HomePlug AV Specification for the specific rules used to generate each type of key.</p>
<div class="highlight-c"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&lt;stdio.h&gt;</span><span class="cp"></span>

<span class="cp">#include</span> <span class="cpf">&quot;../crypt/SHA256.h&quot;</span><span class="cp"></span>

<span class="cp">#include</span> <span class="cpf">&quot;../crypt/SHA256Reset.c&quot;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&quot;../crypt/SHA256Block.c&quot;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&quot;../crypt/SHA256Write.c&quot;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&quot;../crypt/SHA256Fetch.c&quot;</span><span class="cp"></span>

<span class="k">struct</span> <span class="n">sha256</span> <span class="n">sha256</span><span class="p">;</span>
<span class="kt">char</span> <span class="o">*</span> <span class="n">seed</span> <span class="o">=</span> <span class="s">&quot;ForMeToKnowAndYouToFindOut&quot;</span><span class="p">;</span>
<span class="kt">char</span> <span class="o">*</span> <span class="n">salt</span> <span class="o">=</span> <span class="s">&quot;X$z@p&quot;</span><span class="p">;</span>
<span class="n">byte</span> <span class="n">digest</span> <span class="p">[</span><span class="n">SHA256_DIGEST_SIZE</span><span class="p">];</span>
<span class="kt">int</span> <span class="n">i</span><span class="p">;</span>

<span class="n">SHA256Reset</span> <span class="p">(</span><span class="o">&amp;</span><span class="n">sha256</span><span class="p">);</span>
<span class="n">SHA256Write</span> <span class="p">(</span><span class="o">&amp;</span><span class="n">sha256</span><span class="p">,</span> <span class="p">(</span><span class="n">byte</span> <span class="o">*</span><span class="p">)(</span><span class="n">seed</span><span class="p">),</span> <span class="n">strlen</span> <span class="p">(</span><span class="n">seed</span><span class="p">));</span>
<span class="n">SHA256Write</span> <span class="p">(</span><span class="o">&amp;</span><span class="n">sha256</span><span class="p">,</span> <span class="p">(</span><span class="n">byte</span> <span class="o">*</span><span class="p">)(</span><span class="n">salt</span><span class="p">),</span> <span class="n">strlen</span> <span class="p">(</span><span class="n">salt</span><span class="p">));</span>
<span class="n">SHA256Fetch</span> <span class="p">(</span><span class="o">&amp;</span><span class="n">sha256</span><span class="p">,</span> <span class="n">digest</span><span class="p">);</span>

<span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">999</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>
<span class="p">{</span>
        <span class="n">SHA256Reset</span> <span class="p">(</span><span class="o">&amp;</span><span class="n">sha256</span><span class="p">);</span>
        <span class="n">SHA256Write</span> <span class="p">(</span><span class="o">&amp;</span><span class="n">sha256</span><span class="p">,</span> <span class="n">digest</span><span class="p">,</span> <span class="k">sizeof</span> <span class="p">(</span><span class="n">digest</span><span class="p">));</span>
        <span class="n">SHA256Fetch</span> <span class="p">(</span><span class="o">&amp;</span><span class="n">sha256</span><span class="p">,</span> <span class="n">digest</span><span class="p">);</span>
<span class="p">}</span>
<span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>  <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">16</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>
<span class="p">{</span>
        <span class="n">printf</span> <span class="p">(</span><span class="s">&quot;%02x&quot;</span><span class="p">,</span> <span class="n">digest</span> <span class="p">[</span><span class="n">i</span><span class="p">]);</span>
<span class="p">}</span>
<span class="n">printf</span> <span class="p">(</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
</pre></div>
</div>
<p>Above, we declare struct <code class="docutils literal"><span class="pre">sha256</span></code> and initialize it using function <a class="reference internal" href="#support-sha256reset"><span class="std std-ref">SHA256Reset</span></a>. We then write a user-defined seed string (or password) followed by an optional salt string to the digest using function <a class="reference internal" href="#support-sha256write"><span class="std std-ref">SHA256Write</span></a>. The resulting digest (or key) is obtained by calling function <a class="reference internal" href="#support-sha256fetch"><span class="std std-ref">SHA256Fetch</span></a>. Constant <code class="docutils literal"><span class="pre">SHA256_DIGEST_SIZE</span></code> is defined in <a class="reference external" href="SHA256.h.html">SHA256.h</a>. Although the digest is probably secure enough at this point, we rehash it <code class="docutils literal"><span class="pre">999</span></code> times for good measure. We then print the first <code class="docutils literal"><span class="pre">16</span></code> bytes of the result because HomePlug AV keys are always <code class="docutils literal"><span class="pre">16</span></code> bytes long.</p>
</div>
<div class="section" id="macpasswords">
<span id="support-macpasswords"></span><h3>MACPasswords<a class="headerlink" href="#macpasswords" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="c.MACPasswords">
void <code class="descname">MACPasswords</code><span class="sig-paren">(</span>uint32_t<em>&nbsp;vendor</em>, uint32_t<em>&nbsp;device</em>, uint32_t<em>&nbsp;number</em>, unsigned<em>&nbsp;count</em>, unsigned<em>&nbsp;bunch</em>, unsigned<em>&nbsp;space</em>, flag_t<em>&nbsp;flags</em><span class="sig-paren">)</span><a class="headerlink" href="#c.MACPasswords" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>Print a range of device addresses and user passwords on stdout. The calling application must split the starting device address into a three-byte OUI and three-byte device number and pass them as the unsigned 32-bit integers <code class="docutils literal"><span class="pre">vendor</span></code> and <code class="docutils literal"><span class="pre">device</span></code>, respectively. Argument <code class="docutils literal"><span class="pre">device</span></code> is the first device number in the range and <code class="docutils literal"><span class="pre">number</span></code> is the final device number. Argument <code class="docutils literal"><span class="pre">count</span></code> is the number of uppercase letters comprising a password. Passwords contain this many letters but the letters are grouped for easy reading. Letter groups are separated by hyphens. Argument <code class="docutils literal"><span class="pre">bunch</span></code> defines how many letters form each group. Argument <code class="docutils literal"><span class="pre">space</span></code> is the character used to separate groups of letters. Argument <code class="docutils literal"><span class="pre">flags</span></code> enables or disables function features such as insertion of a &#8220;used&#8221; flag for use by the Atheros Production Test System or the omission of the device address on output. The output of this function is similar to that produced by the <strong class="program">DB Builder</strong> utility distributed with the PTS. This function is declared in <a class="reference external" href="keys.h.html">keys.h</a> and defined in <a class="reference external" href="MACPasswords.c.html">MACPasswords.c</a>.</p>
</div>
<div class="section" id="hpavkeydak">
<span id="support-hpavkeydak"></span><h3>HPAVKeyDAK<a class="headerlink" href="#hpavkeydak" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="c.HPAVKeyDAK">
void <code class="descname">HPAVKeyDAK</code><span class="sig-paren">(</span>byte<em>&nbsp;DAK[]</em>, char const<em>&nbsp;*string</em><span class="sig-paren">)</span><a class="headerlink" href="#c.HPAVKeyDAK" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>Encode buffer <code class="docutils literal"><span class="pre">DAK</span></code> with the Device Access Key (DAK) derived from the <code class="docutils literal"><span class="pre">NUL</span></code> terminated <code class="docutils literal"><span class="pre">string</span></code>. The <code class="docutils literal"><span class="pre">string</span></code> is salted, hashed and re-hashed using the SHA256 algorithm. The <code class="docutils literal"><span class="pre">DAK</span></code> is always <code class="docutils literal"><span class="pre">HPAVKEY_DAK_LEN</span></code> bytes, defined in <a class="reference external" href="HPAVKey.h.html">HPAVKey.h</a>,  so no length argument is needed. See the HomePlug AV Specification for more information. This function is declared in <a class="reference external" href="HPAVKey.h.html">HPAVKey.h</a> and defined in <a class="reference external" href="HPAVKeyDAK.c.html">HPAVKeyDAK.c</a>.</p>
</div>
<div class="section" id="hpavkeynmk">
<span id="support-hpavkeynmk"></span><h3>HPAVKeyNMK<a class="headerlink" href="#hpavkeynmk" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="c.HPAVKeyNMK">
void <code class="descname">HPAVKeyNMK</code><span class="sig-paren">(</span>byte<em>&nbsp;digest[]</em>, char const<em>&nbsp;*string</em><span class="sig-paren">)</span><a class="headerlink" href="#c.HPAVKeyNMK" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>Encode buffer <code class="docutils literal"><span class="pre">NMK</span></code> with the Network Membership Key (NMK) derived from the <code class="docutils literal"><span class="pre">NUL</span></code> terminated <code class="docutils literal"><span class="pre">string</span></code>. The string is salted, hashed and re-hashed using the SHA256 algorithm. The <code class="docutils literal"><span class="pre">DAK</span></code> is always <code class="docutils literal"><span class="pre">HPAVKEY_NMK_LEN</span></code> bytes,  as defined in <a class="reference external" href="HPAVKey.h.html">HPAVKey.h</a>,  so no length argument is needed. See the HomePlug AV Specification for more information. This function is declared in <a class="reference external" href="HPAVKey.h.html">HPAVKey.h</a> and defined in <a class="reference external" href="HPAVKeyNMK.c.html">HPAVKeyNMK.c</a>.</p>
</div>
<div class="section" id="hpavkeynid">
<span id="support-hpavkeynid"></span><h3>HPAVKeyNID<a class="headerlink" href="#hpavkeynid" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="c.HPAVKeyNID">
void <code class="descname">HPAVKeyNID</code><span class="sig-paren">(</span>byte<em>&nbsp;NID[]</em>, byte const<em>&nbsp;NMK[]</em>, signed<em>&nbsp;level</em><span class="sig-paren">)</span><a class="headerlink" href="#c.HPAVKeyNID" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>Encode buffer <code class="docutils literal"><span class="pre">NID</span></code> with the Network Identification Key (NID) derived from the 16-byte Network Membership Key (NMK). The <code class="docutils literal"><span class="pre">NMK</span></code> is hashed and re-hashed using the SHA256 algorithm then encoded with the security <code class="docutils literal"><span class="pre">level</span></code>. The <code class="docutils literal"><span class="pre">NID</span></code> is always <code class="docutils literal"><span class="pre">HPAVKEY_NID_LEN</span></code> bytes,  as defined in <a class="reference external" href="HPAVKey.h.html">HPAVKey.h</a>,  so no length argument is needed. See the HomePlug AV Specification for more information. This function is declared in <a class="reference external" href="HPAVKey.h.html">HPAVKey.h</a> and defined in <a class="reference external" href="HPAVKeyNID.c.html">HPAVKeyNID.c</a>.</p>
</div>
<div class="section" id="hpavkeyout">
<span id="support-hpavkeyout"></span><h3>HPAVKeyOut<a class="headerlink" href="#hpavkeyout" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="c.HPAVKeyOut">
void <code class="descname">HPAVKeyOut</code><span class="sig-paren">(</span>byte const<em>&nbsp;digest[]</em>, size_t<em>&nbsp;length</em>, char const<em>&nbsp;*phrase</em>, flag_t<em>&nbsp;flags</em><span class="sig-paren">)</span><a class="headerlink" href="#c.HPAVKeyOut" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>Decode and print up to <code class="docutils literal"><span class="pre">length</span></code> bytes from buffer <code class="docutils literal"><span class="pre">digest</span></code> on stdout. Print <code class="docutils literal"><span class="pre">NUL</span></code> terminated <code class="docutils literal"><span class="pre">phrase</span></code> on the same line following the digest when bit <code class="docutils literal"><span class="pre">HPAVKEY_VERBOSE</span></code>, defined in <a class="reference external" href="HPAVKey.h.html">HPAVKey.h</a>, is set in <code class="docutils literal"><span class="pre">flags</span></code>. This procedure prints keys and phrases in a standard column-oriented format that other applications can easily read and use. This function is declared in <a class="reference external" href="HPAVKey.h.html">HPAVKey.h</a> and defined in <a class="reference external" href="HPAVKeyOut.c.html">HPAVKeyOut.c</a>.</p>
</div>
<div class="section" id="sha256block">
<span id="support-sha256block"></span><h3>SHA256Block<a class="headerlink" href="#sha256block" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="c.SHA256Block">
void <code class="descname">SHA256Block</code><span class="sig-paren">(</span>struct sha256<em>&nbsp;*sha256</em>, void const<em>&nbsp;*memory</em><span class="sig-paren">)</span><a class="headerlink" href="#c.SHA256Block" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>Merge 64 bytes of memory into the current SHA256 digest. This function performs the core computations required by the SHA256 algoithm. It is called by function <a class="reference internal" href="#support-sha256fetch"><span class="std std-ref">SHA256Fetch</span></a> and so there is no reason to call this function directly. The <code class="docutils literal"><span class="pre">sha256</span></code> structure is defined in <a class="reference external" href="SHA256.h.html">SHA256.h</a>. The function is declared in <a class="reference external" href="SHA256.h.html">SHA256.h</a> and defined in <a class="reference external" href="SHA256Block.c.html">SHA256Block.c</a>.</p>
</div>
<div class="section" id="sha256fetch">
<span id="support-sha256fetch"></span><h3>SHA256Fetch<a class="headerlink" href="#sha256fetch" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="c.SHA256Fetch">
void <code class="descname">SHA256Fetch</code><span class="sig-paren">(</span>struct sha256<em>&nbsp;*sha256</em>, byte<em>&nbsp;digest[]</em><span class="sig-paren">)</span><a class="headerlink" href="#c.SHA256Fetch" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>Conclude SHA256 computation and transfer the result to the named 32-byte <code class="docutils literal"><span class="pre">digest</span></code> then flush the <code class="docutils literal"><span class="pre">sha256</span></code> structure. The <code class="docutils literal"><span class="pre">digest</span></code> is always 32 bytes long regardless of the amount of information that has been written using function <a class="reference internal" href="#support-sha256write"><span class="std std-ref">SHA256Write</span></a>. The <code class="docutils literal"><span class="pre">sha256</span></code> structure is defined in <a class="reference external" href="SHA256.h.html">SHA256.h</a>. This function is declared in <a class="reference external" href="SHA256.h.html">SHA256.h</a> and defined in <a class="reference external" href="SHA256Fetch.c.html">SHA256Fetch.c</a>.</p>
<p>Once this function is called, the <code class="docutils literal"><span class="pre">sha256</span></code> structure is purged for security reasons. You must call <a class="reference internal" href="#support-sha256reset"><span class="std std-ref">SHA256Reset</span></a> again before starting another hash or subsequent calls to this function or <a class="reference internal" href="#support-sha256write"><span class="std std-ref">SHA256Write</span></a> will have unpredictable results. .</p>
</div>
<div class="section" id="sha256ident">
<span id="support-sha256ident"></span><h3>SHA256Ident<a class="headerlink" href="#sha256ident" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="c.SHA256Ident">
void <code class="descname">SHA256Ident</code><span class="sig-paren">(</span>int<em>&nbsp;fd</em>, byte<em>&nbsp;digest[]</em><span class="sig-paren">)</span><a class="headerlink" href="#c.SHA256Ident" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>Compute the SHA256 digest from the content of a file. The digest serves as the file &#8220;fingerprint&#8221; and can be used to identify identical content despite filename changes. File descriptor <code class="docutils literal"><span class="pre">fd</span></code> is the subject file which must be positioned to the start befor calling this function. Buffer <code class="docutils literal"><span class="pre">digest</span></code> will be written with the computed 256-digest and must be <code class="docutils literal"><span class="pre">SHA256_DIGEST_SIZE</span></code> bytes long, as defined in <a class="reference external" href="SHA256.h.html">SHA256.h</a>. This function is declared in <a class="reference external" href="SHA256.h.html">SHA256.h</a> and defined in <a class="reference external" href="SHA256Ident.c.html">SHA256Ident.c</a>.</p>
</div>
<div class="section" id="sha256match">
<span id="support-sha256match"></span><h3>SHA256Match<a class="headerlink" href="#sha256match" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="c.SHA256Match">
void <code class="descname">SHA256Match</code><span class="sig-paren">(</span>int<em>&nbsp;fd</em>, byte const<em>&nbsp;digest[]</em><span class="sig-paren">)</span><a class="headerlink" href="#c.SHA256Match" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>Search a registry file for a known SHA256 digest. Return <code class="docutils literal"><span class="pre">true</span></code> on success or <code class="docutils literal"><span class="pre">false</span></code> on failure. File descriptor <code class="docutils literal"><span class="pre">fd</span></code> is the registry file which must be positioned to the start before calling this function. Buffer <code class="docutils literal"><span class="pre">digest</span></code> contains the known 256-bit digest and must be <code class="docutils literal"><span class="pre">SHA256_DIGEST_SIZE</span></code> bytes long, as defined in <a class="reference external" href="SHA256.h.html">SHA256.h</a>. A registry file consists of 64-digit hexadecimal strings that represent SHA256 digest values. Optional text may be appear between the digest and newline to document digest significance. This function ignores such text. This function is declared in <a class="reference external" href="SHA256.h.html">SHA256.h</a> and defined in <a class="reference external" href="SHA256Match.c.html">SHA256Match.c</a>.</p>
</div>
<div class="section" id="sha256print">
<span id="support-sha256print"></span><h3>SHA256Print<a class="headerlink" href="#sha256print" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="c.SHA256Print">
void <code class="descname">SHA256Print</code><span class="sig-paren">(</span>byte const<em>&nbsp;digest[]</em>, char const<em>&nbsp;*string</em><span class="sig-paren">)</span><a class="headerlink" href="#c.SHA256Print" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>Print an SHA256 <code class="docutils literal"><span class="pre">digest</span></code> and optional <code class="docutils literal"><span class="pre">string</span></code> on <code class="docutils literal"><span class="pre">stdout</span></code>. Buffer <code class="docutils literal"><span class="pre">digest</span></code> must be <code class="docutils literal"><span class="pre">SHA256_DIGEST_SIZE</span></code> bytes long, as defined in <a class="reference external" href="SHA256.h.html">SHA256.h</a>, which results in 64 hexadecimal digits on output. Variable length string is <code class="docutils literal"><span class="pre">NUL</span></code> terminated but may be <code class="docutils literal"><span class="pre">NULL</span></code>. If <code class="docutils literal"><span class="pre">string</span></code> is not <code class="docutils literal"><span class="pre">NULL</span></code> and is not empty then a space is inserted between the digest and the string on output. This function may be used to print SHA256 digests and optional strings in standard format,  such as a registry file. This function is declared in <a class="reference external" href="SHA256.h.html">SHA256.h</a> and defined in <a class="reference external" href="SHA256Print.c.html">SHA256Print.c</a>.</p>
</div>
<div class="section" id="sha256reset">
<span id="support-sha256reset"></span><h3>SHA256Reset<a class="headerlink" href="#sha256reset" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="c.SHA256Reset">
void <code class="descname">SHA256Reset</code><span class="sig-paren">(</span>struct sha256<em>&nbsp;*sha256</em><span class="sig-paren">)</span><a class="headerlink" href="#c.SHA256Reset" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>Initialize a <code class="docutils literal"><span class="pre">sha256</span></code> structure before computing a new SHA256 digest. This function should be called once before calling <a class="reference internal" href="#support-sha256write"><span class="std std-ref">SHA256Write</span></a> for the first time for a given digest. The <code class="docutils literal"><span class="pre">sha256</span></code> structure is defined in <a class="reference external" href="SHA256.h.html">SHA256.h</a>. This function is declared in <a class="reference external" href="SHA256.h.html">SHA256.h</a> and defined in <a class="reference external" href="SHA256Reset.c.html">SHA256Reset.c</a>.</p>
</div>
<div class="section" id="sha256write">
<span id="support-sha256write"></span><h3>SHA256Write<a class="headerlink" href="#sha256write" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="c.SHA256Write">
void <code class="descname">SHA256Write</code><span class="sig-paren">(</span>struct sha256<em>&nbsp;*sha256</em>, void const<em>&nbsp;*memory</em>, size_t<em>&nbsp;extent</em><span class="sig-paren">)</span><a class="headerlink" href="#c.SHA256Write" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>Writes a region of memory to the current SHA256 digest contained in an <code class="docutils literal"><span class="pre">sha256</span></code> structure. An application may call this function any number of times to concatinate multiple memory regions before fetching the digest with function <code class="docutils literal"><span class="pre">SHA256Fetch</span></code>. The <code class="docutils literal"><span class="pre">sha256</span></code> structure is defined in <a class="reference external" href="SHA256.h.html">SHA256.h</a>.  This function is declared in <a class="reference external" href="SHA256.h.html">SHA256.h</a> and defined in <a class="reference external" href="SHA256Write.c.html">SHA256Write.c</a>.</p>
</div>
</div>
<div class="section" id="xml-editing-functions">
<span id="support-xml"></span><h2>XML Editing Functions<a class="headerlink" href="#xml-editing-functions" title="Permalink to this headline">¶</a></h2>
<p>Atheros provides support for remote PIB management using XML instruction files. The concept is based on an XML schema that defines the elements and attributes needed to edit a PIB file. The schema is located in file piboffset.xsd. In practice, this schema could be used to edit any buffer containing data but we are only interested in editing PIB files here.</p>
<p>Users may create XML files that conform to the schema and specify the PIB objects they want to change and how they want each to change. In brief, the files specify an <code class="docutils literal"><span class="pre">offset</span></code>, a data <code class="docutils literal"><span class="pre">length</span></code> and a data value. A data value has type <code class="docutils literal"><span class="pre">dataString</span></code>, <code class="docutils literal"><span class="pre">dataHex</span></code> or <code class="docutils literal"><span class="pre">dataByte</span></code> and may be a single data item or an array of data items. Each XML file should include a reference to the Atheros schema and be submitted to a validating XML parser,  such as <strong class="program">Internet Explorer</strong> or <strong class="program">Firefox</strong>,  to ensure that file structure and syntax are correct before use. An example XML file can be seen in piboffset.xml.</p>
<p>Editing involves the following steps. An example of these steps can be seen in the <a class="reference external" href="pxe.c.html">pxe program source code</a> and in function <a class="reference external" href="RdModWrPib2.c.html">RdModWrPib2.c</a> which is a component of the <a class="reference external" href="int6k2.7.html">int6k2</a> program.</p>
<ol class="arabic simple">
<li>Obtain a copy of the PIB to be edited. This can be done by opening a PIB file and reading the entire file into memory or by requesting the PIB directly from an active Atheros powerline device. The PIB length can be determined from the PIB header.</li>
<li>Open the XML file, generate an XML parse tree and close the file. This can be done by passing the filename to function <a class="reference internal" href="#nodes-xmlopen"><span class="std std-ref">xmlopen</span></a>. It will perform all these steps and return the parse tree root node.</li>
<li>Modify the PIB based to instructions stored in the parse tree. This is done by passing the parse tree, PIB buffer and PIB length to function <a class="reference internal" href="#nodes-xmledit"><span class="std std-ref">xmledit</span></a>. It will traverse the parse tree and apply changes to the buffer as defined in the parse tree.</li>
<li>Discard the parse tree. This can be done by passing the parse tree to function <a class="reference internal" href="#nodes-xmlfree"><span class="std std-ref">xmlfree</span></a>.</li>
<li>Compute a new PIB checksum. This can be done by clearing the PIB checksum then passing the PIB buffer and PIB length to function <a class="reference internal" href="#support-checksum32"><span class="std std-ref">checksum32</span></a> with a checksum value of <code class="docutils literal"><span class="pre">0</span></code>.</li>
<li>Write the PIB to file or transmit it over the network to an Atheros powerline device.</li>
</ol>
<div class="section" id="xmledit">
<span id="nodes-xmledit"></span><h3>xmledit<a class="headerlink" href="#xmledit" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="c.xmledit">
signed <code class="descname">xmledit</code><span class="sig-paren">(</span>struct node<em>&nbsp;*node</em>, void<em>&nbsp;*memory</em>, unsigned<em>&nbsp;extent</em><span class="sig-paren">)</span><a class="headerlink" href="#c.xmledit" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>Write data into <code class="docutils literal"><span class="pre">memory</span></code> based on the data offset and length defined in XML parse tree, <code class="docutils literal"><span class="pre">node</span></code>. This function will not apply modifications having malformed structure or having an invalid or illegal offset, length or data value. Use function <a class="reference internal" href="#nodes-xmlschema"><span class="std std-ref">xmlschema</span></a> to print the current schema. The function is declared in <a class="reference external" href="node.h.html">node.h</a> and defined in <a class="reference external" href="xmledit.c.html">xmledit.c</a>. The <code class="docutils literal"><span class="pre">node</span></code> structure is defined in <a class="reference external" href="node.h.html">node.h</a>.</p>
</div>
<div class="section" id="xmlfree">
<span id="nodes-xmlfree"></span><h3>xmlfree<a class="headerlink" href="#xmlfree" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="c.xmlfree">
void <code class="descname">xmlfree</code><span class="sig-paren">(</span>struct node<em>&nbsp;*node</em><span class="sig-paren">)</span><a class="headerlink" href="#c.xmlfree" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>Release memory associated with an XML parse tree. The function is declared in <a class="reference external" href="node.h.html">node.h</a> and defined in <a class="reference external" href="xmlfree.c.html">xmlfree.c</a>. The <code class="docutils literal"><span class="pre">node</span></code> structure is defined in <a class="reference external" href="node.h.html">node.h</a>.</p>
<p>The <code class="docutils literal"><span class="pre">text</span></code> member if the parse tree root node points to memory allocated by <a class="reference internal" href="#nodes-xmlscan"><span class="std std-ref">xmlscan</span></a> to store the original XML string. The application must either deallocate that memory before calling this function or store the text address and deallocate that memory after calling this function;  otherwise, memory leaks will result.</p>
</div>
<div class="section" id="xmlnode">
<span id="nodes-xmlnode"></span><h3>xmlnode<a class="headerlink" href="#xmlnode" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="c.xmlnode">
struct node *<code class="descname">xmlnode</code><span class="sig-paren">(</span>struct node<em>&nbsp;*node</em><span class="sig-paren">)</span><a class="headerlink" href="#c.xmlnode" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>Create an empty node blow the specified node and return a pointer to it. A typical application can be seen in function <a class="reference external" href="xmlscan.c.html">xmlscan.c</a>. The function is declared in <a class="reference external" href="node.h.html">node.h</a> and defined in <a class="reference external" href="xmlnode.c.html">xmlnode.c</a>. The <code class="docutils literal"><span class="pre">node</span></code> structure is defined in <a class="reference external" href="node.h.html">node.h</a>.</p>
</div>
<div class="section" id="xmlopen">
<span id="nodes-xmlopen"></span><h3>xmlopen<a class="headerlink" href="#xmlopen" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="c.xmlopen">
struct node *<code class="descname">xmlopen</code><span class="sig-paren">(</span>char const<em>&nbsp;*filename</em><span class="sig-paren">)</span><a class="headerlink" href="#c.xmlopen" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>Open the named XML file, parse it and return the XML parse tree. The parse tree contains, among other things, all XML elements,  attributes and values specified in the file. The function is declared in <a class="reference external" href="node.h.html">node.h</a> and defined in <a class="reference external" href="xmlopen.c.html">xmlopen.c</a>. The <code class="docutils literal"><span class="pre">node</span></code> structure is defined in <a class="reference external" href="node.h.html">node.h</a>.</p>
<p>The returned parse tree is ready to traverse using struct <code class="docutils literal"><span class="pre">node</span></code> members <code class="docutils literal"><span class="pre">above</span></code>, <code class="docutils literal"><span class="pre">below</span></code>, <code class="docutils literal"><span class="pre">prior</span></code> and <code class="docutils literal"><span class="pre">after</span></code>. Each node has a <code class="docutils literal"><span class="pre">line</span></code>, <code class="docutils literal"><span class="pre">type</span></code> and <code class="docutils literal"><span class="pre">test</span></code> member. This function calls function <a class="reference internal" href="#nodes-xmlscan"><span class="std std-ref">xmlscan</span></a> to parse the file and generate the tree. The parse tree can be inspected by passing the root node to function <a class="reference internal" href="#nodes-xmltree"><span class="std std-ref">xmltree</span></a>.</p>
</div>
<div class="section" id="xmlscan">
<span id="nodes-xmlscan"></span><h3>xmlscan<a class="headerlink" href="#xmlscan" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="c.xmlscan">
signed <code class="descname">xmlscan</code><span class="sig-paren">(</span>struct node<em>&nbsp;*node</em><span class="sig-paren">)</span><a class="headerlink" href="#c.xmlscan" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>Scan the XML string attached to the specified <code class="docutils literal"><span class="pre">node</span></code> and create a parse tree below it. Return <code class="docutils literal"><span class="pre">0</span></code> if parsing is successrul or <code class="docutils literal"><span class="pre">-1</span></code> if not. The function is declared in <a class="reference external" href="node.h.html">node.h</a> and defined in <a class="reference external" href="xmlscan.c.html">xmlscan.c</a>. The <code class="docutils literal"><span class="pre">node</span></code> structure is defined in <a class="reference external" href="node.h.html">node.h</a>.</p>
<p>The application must point the <code class="docutils literal"><span class="pre">text</span></code> member to a  copy of the XML string before calling this function because parsing is destructive and requires write access to the string. The application can search and manipulate the tree on return. The application should deallocate string memory before calling <a class="reference internal" href="#nodes-xmlfree"><span class="std std-ref">xmlfree</span></a>.</p>
<div class="section" id="xml-source-file">
<span id="nodes-example-1"></span><h4>XML Source File<a class="headerlink" href="#xml-source-file" title="Permalink to this headline">¶</a></h4>
<p>The following is sample input to function <code class="docutils literal"><span class="pre">xmlscan</span></code>. The element and attribute names shown are for illustration and were selected to that they can be easily identified in the output. The parse tree from this file can be seen in the example for function <a class="reference internal" href="#nodes-example-2"><span class="std std-ref">xmltree</span></a>.</p>
<div class="highlight-xml"><div class="highlight"><pre><span></span><span class="cp">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;</span>
<span class="nt">&lt;xmlfile</span>
        <span class="na">xmlns:xsi=</span><span class="s">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span>
        <span class="na">xsi:noNamespaceSchemaLocation=</span><span class="s">&quot;myschema.xsd&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;element</span> <span class="na">name=</span><span class="s">&quot;Element1&quot;</span><span class="nt">&gt;</span>
                <span class="nt">&lt;attribute</span> <span class="na">name=</span><span class="s">&quot;Attribute1&quot;</span><span class="nt">&gt;</span>
                        1234567890
                        <span class="nt">&lt;/attribute&gt;</span>
                <span class="nt">&lt;attribute</span> <span class="na">name=</span><span class="s">&quot;Attribute2&quot;</span><span class="nt">&gt;</span>
                        The quick brown fox jumped over the lazy dog.
                        <span class="nt">&lt;/attribute&gt;</span>
                <span class="nt">&lt;/element&gt;</span>
        <span class="nt">&lt;element</span> <span class="na">name=</span><span class="s">&quot;Element2&quot;</span><span class="nt">&gt;</span>
                <span class="nt">&lt;attribute</span> <span class="na">name=</span><span class="s">&quot;Attribute1&quot;</span><span class="nt">&gt;</span>
                        <span class="nt">&lt;/attribute&gt;</span>
                <span class="nt">&lt;attribute</span> <span class="na">name=</span><span class="s">&quot;Attribute2&quot;</span><span class="nt">&gt;</span>
                        The quick brown
                        fox jumped over
                        the lazy dog.
                        <span class="nt">&lt;/attribute&gt;</span>
                <span class="nt">&lt;/element&gt;</span>
<span class="c">&lt;!-- comments can go anywhere --&gt;</span>
        <span class="nt">&lt;element</span> <span class="na">name=</span><span class="s">&quot;Element2&quot;</span><span class="nt">&gt;</span>
                <span class="nt">&lt;attribute</span> <span class="na">name=</span><span class="s">&quot;Attribute1&quot;</span><span class="nt">/&gt;</span>
                <span class="nt">&lt;attribute</span> <span class="na">name=</span><span class="s">&quot;Attribute2&quot;</span><span class="nt">&gt;</span>
                        value2
                        <span class="nt">&lt;/attribute&gt;</span>
                <span class="nt">&lt;/element&gt;</span>
        <span class="nt">&lt;/xmlfile&gt;</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="xmlschema">
<span id="nodes-xmlschema"></span><h3>xmlschema<a class="headerlink" href="#xmlschema" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="c.xmlschema">
void <code class="descname">xmlschema</code><span class="sig-paren">(</span>void<span class="sig-paren">)</span><a class="headerlink" href="#c.xmlschema" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>Print an XML schema that supports function <a class="reference internal" href="#nodes-xmledit"><span class="std std-ref">xmledit</span></a> on stdout. This function has no argument. The schema produced by this function is guaranteed to support the parse logic implemented by function <a class="reference internal" href="#nodes-xmledit"><span class="std std-ref">xmledit</span></a>. Scheme element names are defined as constants in <a class="reference external" href="node.h.html">node.h</a> so that they can be referenced by applications that create their own XML edit instructions. The function is declared in <a class="reference external" href="node.h.html">node.h</a> and defined in <a class="reference external" href="xmlschema.c.html">xmlschema.c</a>.</p>
<p>The <code class="docutils literal"><span class="pre">text</span></code> member in the parse tree root node points to memory allocated by <a class="reference internal" href="#nodes-xmlscan"><span class="std std-ref">xmlscan</span></a> to store the original XML string. The application must either deallocate that memory before calling this function or store the text address and deallocate that memory after calling this function;  otherwise, memory leaks will result.</p>
<div class="section" id="xml-edit-schema">
<h4>XML Edit Schema<a class="headerlink" href="#xml-edit-schema" title="Permalink to this headline">¶</a></h4>
<div class="highlight-xml"><div class="highlight"><pre><span></span><span class="cp">&lt;?xml version=&#39;1.0&#39; encoding=&#39;UTF-8&#39;?&gt;</span>
<span class="nt">&lt;xs:schema</span> <span class="na">xmlns:xs=</span><span class="s">&#39;http://www.w3.org/2001/XMLSchema&#39;</span> <span class="na">elementFormDefault=</span><span class="s">&#39;qualified&#39;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;xs:element</span> <span class="na">name=</span><span class="s">&#39;pib&#39;</span><span class="nt">&gt;</span>
                <span class="nt">&lt;xs:complexType&gt;</span>
                        <span class="nt">&lt;xs:sequence&gt;</span>
                                <span class="nt">&lt;xs:element</span> <span class="na">maxOccurs=</span><span class="s">&#39;unbounded&#39;</span> <span class="na">ref=</span><span class="s">&#39;object&#39;</span><span class="nt">/&gt;</span>
                                <span class="nt">&lt;/xs:sequence&gt;</span>
                        <span class="nt">&lt;/xs:complexType&gt;</span>
                <span class="nt">&lt;/xs:element&gt;</span>
        <span class="nt">&lt;xs:element</span> <span class="na">name=</span><span class="s">&#39;object&#39;</span><span class="nt">&gt;</span>
                <span class="nt">&lt;xs:complexType&gt;</span>
                        <span class="nt">&lt;xs:attribute</span> <span class="na">name=</span><span class="s">&#39;name&#39;</span> <span class="na">use=</span><span class="s">&#39;required&#39;</span> <span class="na">type=</span><span class="s">&#39;xs:NCName&#39;</span><span class="nt">/&gt;</span>
                        <span class="nt">&lt;xs:sequence&gt;</span>
                                <span class="nt">&lt;xs:sequence&gt;</span>
                                        <span class="nt">&lt;xs:element</span> <span class="na">ref=</span><span class="s">&#39;offset&#39;</span><span class="nt">/&gt;</span>
                                        <span class="nt">&lt;xs:element</span> <span class="na">ref=</span><span class="s">&#39;length&#39;</span><span class="nt">/&gt;</span>
                                        <span class="nt">&lt;/xs:sequence&gt;</span>
                                <span class="nt">&lt;xs:choice&gt;</span>
                                        <span class="nt">&lt;xs:element</span> <span class="na">ref=</span><span class="s">&#39;array&#39;</span><span class="nt">/&gt;</span>
                                        <span class="nt">&lt;xs:element</span> <span class="na">ref=</span><span class="s">&#39;dataString&#39;</span><span class="nt">/&gt;</span>
                                        <span class="nt">&lt;xs:element</span> <span class="na">ref=</span><span class="s">&#39;dataByte&#39;</span><span class="nt">/&gt;</span>
                                        <span class="nt">&lt;/xs:choice&gt;</span>
                                <span class="nt">&lt;/xs:sequence&gt;</span>
                        <span class="nt">&lt;/xs:complexType&gt;</span>
                <span class="nt">&lt;/xs:element&gt;</span>
        <span class="nt">&lt;xs:element</span> <span class="na">name=</span><span class="s">&#39;length&#39;</span> <span class="na">type=</span><span class="s">&#39;xs:positiveInteger&#39;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;xs:element</span> <span class="na">name=</span><span class="s">&#39;offset&#39;</span> <span class="na">type=</span><span class="s">&#39;xs:hexBinary&#39;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;xs:element</span> <span class="na">name=</span><span class="s">&#39;array&#39;</span><span class="nt">&gt;</span>
                <span class="nt">&lt;xs:complexType&gt;</span>
                        <span class="nt">&lt;xs:choice</span> <span class="na">maxOccurs=</span><span class="s">&#39;unbounded&#39;</span><span class="nt">&gt;</span>
                                <span class="nt">&lt;xs:element</span> <span class="na">ref=</span><span class="s">&#39;dataByte&#39;</span><span class="nt">/&gt;</span>
                                <span class="nt">&lt;xs:element</span> <span class="na">ref=</span><span class="s">&#39;dataHex&#39;</span><span class="nt">/&gt;</span>
                                <span class="nt">&lt;/xs:choice&gt;</span>
                        <span class="nt">&lt;/xs:complexType&gt;</span>
                <span class="nt">&lt;/xs:element&gt;</span>
        <span class="nt">&lt;xs:element</span> <span class="na">name=</span><span class="s">&#39;dataString&#39;</span> <span class="na">type=</span><span class="s">&#39;xs:string&#39;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;xs:element</span> <span class="na">name=</span><span class="s">&#39;dataHex&#39;</span> <span class="na">type=</span><span class="s">&#39;xs:hexBinary&#39;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;xs:element</span> <span class="na">name=</span><span class="s">&#39;dataByte&#39;</span> <span class="na">type=</span><span class="s">&#39;xs:unsignedByte&#39;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;/xs:schema&gt;</span>
</pre></div>
</div>
<p>The schema shown above was produced by function <a class="reference internal" href="#nodes-xmlschema"><span class="std std-ref">xmlschema</span></a>. It is should be used to validate XML edit instructions before submitting them to program <a class="reference external" href="pxe.7.html">pxe</a>.</p>
</div>
</div>
<div class="section" id="xmltree">
<span id="nodes-xmltree"></span><h3>xmltree<a class="headerlink" href="#xmltree" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="c.xmltree">
void <code class="descname">xmltree</code><span class="sig-paren">(</span>struct node<em>&nbsp;*node</em><span class="sig-paren">)</span><a class="headerlink" href="#c.xmltree" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>Print the XML parse tree on stdout. The function is declared in <a class="reference external" href="node.h.html">node.h</a> and defined in <a class="reference external" href="xmltree.c.html">xmltree.c</a>.</p>
<div class="section" id="xml-parse-tree">
<span id="nodes-example-2"></span><h4>XML Parse Tree<a class="headerlink" href="#xml-parse-tree" title="Permalink to this headline">¶</a></h4>
<p>The following is sample output from function <code class="docutils literal"><span class="pre">xmltree</span></code>. The XML source is shown in the example for function <a class="reference internal" href="#nodes-example-1"><span class="std std-ref">xmlscan</span></a>. The numbers appearing down the left margin indicate the input line number from the XML source file parsed by function <a class="reference internal" href="#nodes-xmlscan"><span class="std std-ref">xmlscan</span></a>. The character codes indicate the node type and are defined in <a class="reference external" href="node.h.html">node.h</a>. The <code class="docutils literal"><span class="pre">node</span></code> structure is defined in <a class="reference external" href="node.h.html">node.h</a>.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>001 [?] [xml]
001 [ ]     [version]
001 [=]             [1.0]
001 [ ]     [encoding]
001 [=]             [UTF-8]
002 [&lt;] [xmlfile]
002 [ ]     [xmlns:xsi]
002 [=]             [http://www.w3.org/2001/XMLSchema-instance]
002 [ ]     [xsi:noNamespaceSchemaLocation]
002 [=]             [myschema.xsd]
003 [&lt;]     [element]
003 [ ]             [name]
003 [=]                     [Element1]
004 [&lt;]             [attribute]
004 [ ]                     [name]
004 [=]                             [Attribute1]
005 [&gt;]                     [1234567890]
006 [/]                     [attribute]
007 [&lt;]             [attribute]
007 [ ]                     [name]
007 [=]                             [Attribute2]
008 [&gt;]                     [The quick brown fox jumped over the lazy dog.]
009 [/]                     [attribute]
010 [/]             [element]
011 [&lt;]     [element]
011 [ ]             [name]
011 [=]                     [Element2]
012 [&lt;]             [attribute]
012 [ ]                     [name]
012 [=]                             [Attribute1]
013 [/]                     [attribute]
014 [&lt;]             [attribute]
014 [ ]                     [name]
014 [=]                             [Attribute2]
015 [&gt;]                     [The quick brown fox jumped over the lazy dog.azy]
018 [/]                     [attribute]
019 [/]             [element]
020 [!]     [-- comments can go anywhere --]
021 [&lt;]     [element]
021 [ ]             [name]
021 [=]                     [Element2]
022 [&lt;]             [attribute]
022 [ ]                     [name]
022 [=]                             [Attribute1]
023 [&lt;]             [attribute]
023 [ ]                     [name]
023 [=]                             [Attribute2]
024 [&gt;]                     [value2]
025 [/]                     [attribute]
026 [/]             [element]
027 [/]     [xmlfile]
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="download-functions">
<span id="support-download"></span><h2>Download Functions<a class="headerlink" href="#download-functions" title="Permalink to this headline">¶</a></h2>
<p>Download function write applets, parameters and runtime firmware to device SDRAM or NVRAM.</p>
<div class="section" id="writeexecuteapplet">
<span id="id84"></span><h3>WriteExecuteApplet<a class="headerlink" href="#writeexecuteapplet" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="c.WriteExecuteApplet">
signed <code class="descname">WriteExecuteApplet</code><span class="sig-paren">(</span>struct plc<em>&nbsp;*plc</em>, void const<em>&nbsp;*header</em><span class="sig-paren">)</span><a class="headerlink" href="#c.WriteExecuteApplet" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>Write an NVM image directly into SDRAM using <code class="docutils literal"><span class="pre">VS_WRITE_AND_EXECUTE</span></code> messages. This function calls either <a class="reference internal" href="#writeexecuteapplet1"><span class="std std-ref">WriteExecuteApplet1</span></a> or <a class="reference internal" href="#writeexecuteapplet2"><span class="std std-ref">WriteExecuteApplet2</span></a> based on the NVM header version. The function is declared in <a class="reference external" href="plc.h.html">plc.h</a> and defined in <a class="reference external" href="WriteExecuteApplet.c.html">WriteExecuteApplet.c</a>. The <code class="docutils literal"><span class="pre">plc</span></code> structure is defined in <a class="reference external" href="plc.h.html">plc.h</a>.</p>
</div>
<div class="section" id="writeexecuteapplet1">
<span id="id86"></span><h3>WriteExecuteApplet1<a class="headerlink" href="#writeexecuteapplet1" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="c.WriteExecuteApplet1">
signed <code class="descname">WriteExecuteApplet1</code><span class="sig-paren">(</span>struct plc<em>&nbsp;*plc</em>, struct nvm_header1<em>&nbsp;*header</em><span class="sig-paren">)</span><a class="headerlink" href="#c.WriteExecuteApplet1" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>Write an NVM image directly into SDRAM using <code class="docutils literal"><span class="pre">VS_WRITE_AND_EXECUTE</span></code> messages. This function is similar to <a class="reference internal" href="#writeexecuteapplet2"><span class="std std-ref">WriteExecuteApplet2</span></a> but expects a structure <code class="docutils literal"><span class="pre">nvm_header1</span></code> pointer instead of a structure <code class="docutils literal"><span class="pre">nvm_header2</span></code> pointer. The function is declared in <a class="reference external" href="plc.h.html">plc.h</a> and defined in <a class="reference external" href="WriteExecuteApplet.c.html">WriteExecuteApplet.c</a>. Structure <code class="docutils literal"><span class="pre">plc</span></code> is defined in file <a class="reference external" href="plc.h.html">plc.h</a>. Structure <code class="docutils literal"><span class="pre">nvm_header1</span></code> is defined in file <a class="reference external" href="nvm.h.html">nvm.h</a>.</p>
</div>
<div class="section" id="writeexecuteapplet2">
<span id="id90"></span><h3>WriteExecuteApplet2<a class="headerlink" href="#writeexecuteapplet2" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="c.WriteExecuteApplet2">
signed <code class="descname">WriteExecuteApplet2</code><span class="sig-paren">(</span>struct plc<em>&nbsp;*plc</em>, struct nvm_header2<em>&nbsp;*header</em><span class="sig-paren">)</span><a class="headerlink" href="#c.WriteExecuteApplet2" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>Write an NVM image directly into SDRAM using <code class="docutils literal"><span class="pre">VS_WRITE_AND_EXECUTE</span></code> messages. This function is similar to <a class="reference internal" href="#writeexecuteapplet1"><span class="std std-ref">WriteExecuteApplet1</span></a> but expects a structure <code class="docutils literal"><span class="pre">nvm_header2</span></code> pointer instead of a structure <code class="docutils literal"><span class="pre">nvm_header1</span></code> pointer. The function is declared in <a class="reference external" href="plc.h.html">plc.h</a> and defined in <a class="reference external" href="WriteExecuteApplet.c.html">WriteExecuteApplet.c</a>. Structure <code class="docutils literal"><span class="pre">plc</span></code> is defined in file <a class="reference external" href="plc.h.html">plc.h</a>. Structure <code class="docutils literal"><span class="pre">nvm_header1</span></code> is defined in file <a class="reference external" href="nvm.h.html">nvm.h</a>.</p>
</div>
</div>
<div class="section" id="procrastination-functions">
<span id="support-procrastination"></span><h2>Procrastination Functions<a class="headerlink" href="#procrastination-functions" title="Permalink to this headline">¶</a></h2>
<p>Procrastinations functions wait for specific events to occur or fail to occur.</p>
<div class="section" id="waitforassoc">
<span id="id95"></span><h3>WaitForAssoc<a class="headerlink" href="#waitforassoc" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="c.WaitForAssoc">
signed <code class="descname">WaitForAssoc</code><span class="sig-paren">(</span>struct plc<em>&nbsp;*plc</em><span class="sig-paren">)</span><a class="headerlink" href="#c.WaitForAssoc" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>Poll a powerline device using <code class="docutils literal"><span class="pre">VS_NW_INFO</span></code> messages until the device forms or joins a network. The host ethernet interface, destination hardware address and source hardware address are specified in structure <code class="docutils literal"><span class="pre">plc</span></code>. It calls either <a class="reference internal" href="#waitforassoc1"><span class="std std-ref">WaitForAssoc1</span></a> or <a class="reference internal" href="#waitforassoc2"><span class="std std-ref">WaitForAssoc2</span></a> to procrastinate based on the <code class="docutils literal"><span class="pre">hardwareID</span></code> member of structure <code class="docutils literal"><span class="pre">plc</span></code>. The function is declared in <a class="reference external" href="plc.h.html">plc.h</a> and defined in file <a class="reference external" href="WaitForAssoc.c.html">WaitForAssoc.c</a>. Struct <code class="docutils literal"><span class="pre">plc</span></code> is declared in file <a class="reference external" href="plc.h.html">plc.h</a> and defined in file <a class="reference external" href="plc.c.html">plc.c</a>.</p>
</div>
<div class="section" id="waitforassoc1">
<span id="id98"></span><h3>WaitForAssoc1<a class="headerlink" href="#waitforassoc1" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="c.WaitForAssoc1">
signed <code class="descname">WaitForAssoc1</code><span class="sig-paren">(</span>struct plc<em>&nbsp;*plc</em><span class="sig-paren">)</span><a class="headerlink" href="#c.WaitForAssoc1" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>Poll a 200mbs powerline device using <code class="docutils literal"><span class="pre">VS_NW_INFO</span></code> version <code class="docutils literal"><span class="pre">0</span></code> messages until the device joins or forms a network. The host ethernet interface, destination hardware address and source hardware address are specified in structure <code class="docutils literal"><span class="pre">plc</span></code>. The function is declared in file <a class="reference external" href="plc.h.html">plc.h</a> and defined in file <a class="reference external" href="WaitForAssoc1.c.html">WaitForAssoc1.c</a>. Struct <code class="docutils literal"><span class="pre">plc</span></code> is declared in file <a class="reference external" href="plc.h.html">plc.h</a> and defined in file <a class="reference external" href="plc.c.html">plc.c</a>.</p>
</div>
<div class="section" id="waitforassoc2">
<span id="id102"></span><h3>WaitForAssoc2<a class="headerlink" href="#waitforassoc2" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="c.WaitForAssoc2">
signed <code class="descname">WaitForAssoc2</code><span class="sig-paren">(</span>struct plc<em>&nbsp;*plc</em><span class="sig-paren">)</span><a class="headerlink" href="#c.WaitForAssoc2" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>Poll a 1000mbs powerline device using <code class="docutils literal"><span class="pre">VS_NW_INFO</span></code> version <code class="docutils literal"><span class="pre">1</span></code> messages until the device joins or forms a network. The host ethernet interface, destination hardware address and source hardware address are specified in structure <code class="docutils literal"><span class="pre">plc</span></code>. Structure <code class="docutils literal"><span class="pre">plc</span></code> is declared in file <a class="reference external" href="plc.h.html">plc.h</a> and defined in file <a class="reference external" href="plc.c.html">plc.c</a>. The function is declared in file <a class="reference external" href="plc.h.html">plc.h</a> and defined in file <a class="reference external" href="WaitForAssoc2.c.html">WaitForAssoc2.c</a>.</p>
</div>
<div class="section" id="waitforreset">
<span id="id106"></span><h3>WaitForReset<a class="headerlink" href="#waitforreset" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="c.WaitForReset">
signed <code class="descname">WaitForReset</code><span class="sig-paren">(</span>struct plc<em>&nbsp;*plc</em><span class="sig-paren">)</span><a class="headerlink" href="#c.WaitForReset" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>Poll a powerline device using <code class="docutils literal"><span class="pre">VS_SW_VER</span></code> messages until the device stops responding. The host ethernet interface, destination hardware address and source hardware address are specified in structure <code class="docutils literal"><span class="pre">plc</span></code>. Structure <code class="docutils literal"><span class="pre">plc</span></code> is declared in file <a class="reference external" href="plc.h.html">plc.h</a> and define in file <a class="reference external" href="plc.c.html">plc.c</a>. The function is declared in <a class="reference external" href="plc.h.html">plc.h</a> and defined in file <a class="reference external" href="WaitForReset.c.html">WaitForReset.c</a>.</p>
</div>
<div class="section" id="waitforstart">
<span id="id110"></span><h3>WaitForStart<a class="headerlink" href="#waitforstart" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="c.WaitForStart">
signed <code class="descname">WaitForStart</code><span class="sig-paren">(</span>struct plc<em>&nbsp;*plc</em>, char<em>&nbsp;firmware</em>, size_t<em>&nbsp;length</em><span class="sig-paren">)</span><a class="headerlink" href="#c.WaitForStart" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>Poll a powerline device using <code class="docutils literal"><span class="pre">VS_SW_VER</span></code> messages until the device responds. The host ethernet interface, destination hardware address and source hardware address are specified in structure <code class="docutils literal"><span class="pre">plc</span></code>. Update the <code class="docutils literal"><span class="pre">hardwareID</span></code> member of the <code class="docutils literal"><span class="pre">plc</span></code> structure. Return the firmware revision string contained in the confirmation message. Structure <code class="docutils literal"><span class="pre">plc</span></code> is declared in file <a class="reference external" href="plc.h.html">plc.h</a> and defined in file <a class="reference external" href="plc.c.html">plc.c</a>. The function is declared in file <a class="reference external" href="plc.h.html">plc.h</a> and defined in file <a class="reference external" href="WaitForStart.c.html">WaitForStart.c</a>.</p>
</div>
</div>
<div class="section" id="traffic-functions">
<span id="support-traffic"></span><h2>Traffic Functions<a class="headerlink" href="#traffic-functions" title="Permalink to this headline">¶</a></h2>
<p>Traffic functions generate powerline traffic in various ways. Some send traffic direct from the host to each device while others use the <code class="docutils literal"><span class="pre">VS_FR_LBK</span></code> message to echo Ethernet frames back to the sender.</p>
<div class="section" id="crosstraffic1">
<span id="support-crosstraffic1"></span><h3>CrossTraffic1<a class="headerlink" href="#crosstraffic1" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="c.CrossTraffic1">
signed <code class="descname">CrossTraffic1</code><span class="sig-paren">(</span>struct plc<em>&nbsp;*plc</em><span class="sig-paren">)</span><a class="headerlink" href="#c.CrossTraffic1" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>Instruct a powerline device  to send a generic Ethernet frame to another powerline device for a fixed period of time in order to set the <code class="docutils literal"><span class="pre">TX</span></code> rate on the source device and the <code class="docutils literal"><span class="pre">RX</span></code> rate on the destination device. The source and destination address are specified in <code class="docutils literal"><span class="pre">plc-&gt;MAC</span></code> and <code class="docutils literal"><span class="pre">plc-&gt;RDA</span></code>, respectively, and the duration is specified in <code class="docutils literal"><span class="pre">plc-&gt;timeperiod</span></code>. This function is similar to function <a class="reference internal" href="#support-crosstraffic2"><span class="std std-ref">CrossTraffic2</span></a> but the source and destination addresses are reversed. Structure <code class="docutils literal"><span class="pre">plc</span></code> is declared in file <a class="reference external" href="plc.h.html">plc.h</a> and defined in file <a class="reference external" href="plc.c.html">plc.c</a>. The function is declared in <a class="reference external" href="plc.h.html">plc.h</a> and defined in file <a class="reference external" href="CrossTraffic1.c.html">CrossTraffic1.c</a>.</p>
</div>
<div class="section" id="crosstraffic2">
<span id="support-crosstraffic2"></span><h3>CrossTraffic2<a class="headerlink" href="#crosstraffic2" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="c.CrossTraffic2">
signed <code class="descname">CrossTraffic2</code><span class="sig-paren">(</span>struct plc<em>&nbsp;*plc</em><span class="sig-paren">)</span><a class="headerlink" href="#c.CrossTraffic2" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>Instruct a powerline device  to send a generic Ethernet frame to another powerline device for a fixed period of time in order to set the <code class="docutils literal"><span class="pre">TX</span></code> rate on the source device and the <code class="docutils literal"><span class="pre">RX</span></code> rate on the destination device. The source and destination address are specified in <code class="docutils literal"><span class="pre">plc-&gt;RDA</span></code> and <code class="docutils literal"><span class="pre">plc-&gt;MAC</span></code>, respectively, and the duration is specified in <code class="docutils literal"><span class="pre">plc-&gt;timeperiod</span></code>. This function is similar to function <a class="reference internal" href="#support-crosstraffic1"><span class="std std-ref">CrossTraffic1</span></a> but the source and destination addresses are reversed. Structure <code class="docutils literal"><span class="pre">plc</span></code> is declared in file <a class="reference external" href="plc.h.html">plc.h</a> and defined in file <a class="reference external" href="plc.c.html">plc.c</a>. The function is declared in <a class="reference external" href="plc.h.html">plc.h</a> and defined in file <a class="reference external" href="CrossTraffic2.c.html">CrossTraffic2.c</a>.</p>
</div>
<div class="section" id="localtraffic1">
<span id="support-localtraffic1"></span><h3>LocalTraffic1<a class="headerlink" href="#localtraffic1" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="c.LocalTraffic1">
signed <code class="descname">LocalTraffic1</code><span class="sig-paren">(</span>struct plc<em>&nbsp;*plc</em><span class="sig-paren">)</span><a class="headerlink" href="#c.LocalTraffic1" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>Send a fixed number of generic frames from the local host a remote powerline device in order to set the <code class="docutils literal"><span class="pre">TX</span></code> rate on the local powerline device and the <code class="docutils literal"><span class="pre">RX</span></code> rate on the remote powerline device. The local and remote device address are specified in <code class="docutils literal"><span class="pre">plc-&gt;MAC</span></code> and <code class="docutils literal"><span class="pre">plc-&gt;RDA</span></code>, respectively, and the count is specified in <code class="docutils literal"><span class="pre">plc-&gt;count</span></code>. This function is similar to function <a class="reference internal" href="#support-localtraffic2"><span class="std std-ref">LocalTraffic2</span></a> which instructs a remote device to echo frames back to the local device. Structure <code class="docutils literal"><span class="pre">plc</span></code> is declared in file <a class="reference external" href="plc.h.html">plc.h</a> and defined in file <a class="reference external" href="plc.c.html">plc.c</a>. The function is declared in <a class="reference external" href="plc.h.html">plc.h</a> and defined in file <a class="reference external" href="LocalTraffic1.c.html">LocalTraffic1.c</a>.</p>
</div>
<div class="section" id="localtraffic2">
<span id="support-localtraffic2"></span><h3>LocalTraffic2<a class="headerlink" href="#localtraffic2" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="c.LocalTraffic2">
signed <code class="descname">LocalTraffic2</code><span class="sig-paren">(</span>struct plc<em>&nbsp;*plc</em><span class="sig-paren">)</span><a class="headerlink" href="#c.LocalTraffic2" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>Instruct a remote powerline device to echo generic Ethernet frames back to the local host for a fixed period of time in order to set the <code class="docutils literal"><span class="pre">TX</span></code> rate on the remote powerline device and the <code class="docutils literal"><span class="pre">RX</span></code> rate on the local powerline device. The local and remote device address are specified in <code class="docutils literal"><span class="pre">plc-&gt;MAC</span></code> and <code class="docutils literal"><span class="pre">plc-&gt;RDA</span></code>, respectively, and the count is specified in <code class="docutils literal"><span class="pre">plc-&gt;count</span></code>. This function is useful when there is no easy way to send traffic from the remote host. This function complements function <a class="reference internal" href="#support-localtraffic1"><span class="std std-ref">LocalTraffic1</span></a> which send frames from the local device to a remote device. Structure <code class="docutils literal"><span class="pre">plc</span></code> is declared in file <a class="reference external" href="plc.h.html">plc.h</a> and defined in file <a class="reference external" href="plc.c.html">plc.c</a>. The function is declared in <a class="reference external" href="plc.h.html">plc.h</a> and defined in file <a class="reference external" href="LocalTraffic2.c.html">LocalTraffic2.c</a>.</p>
</div>
<div class="section" id="networktraffic1">
<span id="support-networktraffic1"></span><h3>NetworkTraffic1<a class="headerlink" href="#networktraffic1" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="c.NetworkTraffic1">
signed <code class="descname">NetworkTraffic1</code><span class="sig-paren">(</span>struct plc<em>&nbsp;*plc</em><span class="sig-paren">)</span><a class="headerlink" href="#c.NetworkTraffic1" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>This function is an alternative to function <a class="reference internal" href="#support-networktraffic2"><span class="std std-ref">NetworkTraffic2</span></a> which uses Qualcomm Version <code class="docutils literal"><span class="pre">1</span></code> management messages to determine network topology. Structure <code class="docutils literal"><span class="pre">plc</span></code> is declared in file <a class="reference external" href="plc.h.html">plc.h</a> and defined in file <a class="reference external" href="plc.c.html">plc.c</a>. The function is declared in <a class="reference external" href="plc.h.html">plc.h</a> and defined in file <a class="reference external" href="NetworkTraffic1.c.html">NetworkTraffic1.c</a>.</p>
<p>This function use <code class="docutils literal"><span class="pre">VS_SW_INFO</span></code> and <code class="docutils literal"><span class="pre">VS_NW_INFO</span></code> messages to discover powerline network topology then calls functions <a class="reference internal" href="#support-localtraffic1"><span class="std std-ref">LocalTraffic1</span></a> and <a class="reference internal" href="#support-localtraffic2"><span class="std std-ref">LocalTraffic2</span></a> to generate traffic between the local powerline device and each remote powerline device. Unlike function <a class="reference internal" href="#support-networktraffic1"><span class="std std-ref">NetworkTraffic1</span></a>, it does not generate traffic between various remote devices.</p>
</div>
<div class="section" id="networktraffic2">
<span id="support-networktraffic2"></span><h3>NetworkTraffic2<a class="headerlink" href="#networktraffic2" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="c.NetworkTraffic2">
signed <code class="descname">NetworkTraffic2</code><span class="sig-paren">(</span>struct plc<em>&nbsp;*plc</em><span class="sig-paren">)</span><a class="headerlink" href="#c.NetworkTraffic2" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>This function is an alternative to function <a class="reference internal" href="#support-networktraffic1"><span class="std std-ref">NetworkTraffic1</span></a> which uses Qualcomm Version <code class="docutils literal"><span class="pre">0</span></code> management messages to determine network topology. Structure <code class="docutils literal"><span class="pre">plc</span></code> is declared in file <a class="reference external" href="plc.h.html">plc.h</a> and defined in file <a class="reference external" href="plc.c.html">plc.c</a>. The function is declared in <a class="reference external" href="plc.h.html">plc.h</a> and defined in file <a class="reference external" href="NetworkTraffic2.c.html">NetworkTraffic2.c</a>.</p>
</div>
<div class="section" id="traffic1">
<span id="support-traffic1"></span><h3>Traffic1<a class="headerlink" href="#traffic1" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="c.Traffic1">
signed <code class="descname">Traffic1</code><span class="sig-paren">(</span>struct plc<em>&nbsp;*plc</em><span class="sig-paren">)</span><a class="headerlink" href="#c.Traffic1" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>This function is an alternative to function <a class="reference internal" href="#support-traffic2"><span class="std std-ref">Traffic2</span></a> which uses Qualcomm Version <code class="docutils literal"><span class="pre">1</span></code> management messages to determine network topology. Structure <code class="docutils literal"><span class="pre">plc</span></code> is declared in file <a class="reference external" href="plc.h.html">plc.h</a> and defined in file <a class="reference external" href="plc.c.html">plc.c</a>. The function is declared in <a class="reference external" href="plc.h.html">plc.h</a> and defined in file <a class="reference external" href="Traffic1.c.html">Traffic1.c</a>.</p>
<p>This function use <code class="docutils literal"><span class="pre">VS_SW_INFO</span></code> and <code class="docutils literal"><span class="pre">VS_NW_INFO</span></code> messages to discover powerline network topology then calls functions <a class="reference internal" href="#support-localtraffic1"><span class="std std-ref">LocalTraffic1</span></a> and <a class="reference internal" href="#support-localtraffic2"><span class="std std-ref">LocalTraffic2</span></a> to generate traffic between the local powerline device and each remote powerline device. Unlike function <a class="reference internal" href="#support-networktraffic1"><span class="std std-ref">NetworkTraffic1</span></a>, it does not generate traffic between remote devices.</p>
</div>
<div class="section" id="traffic2">
<span id="support-traffic2"></span><h3>Traffic2<a class="headerlink" href="#traffic2" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="c.Traffic2">
signed <code class="descname">Traffic2</code><span class="sig-paren">(</span>struct plc<em>&nbsp;*plc</em><span class="sig-paren">)</span><a class="headerlink" href="#c.Traffic2" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>This function is an alternative to function <a class="reference internal" href="#support-traffic1"><span class="std std-ref">Traffic1</span></a> which uses Qualcomm Version <code class="docutils literal"><span class="pre">0</span></code> management messages to determine network topology. Structure <code class="docutils literal"><span class="pre">plc</span></code> is declared in file <a class="reference external" href="plc.h.html">plc.h</a> and defined in file <a class="reference external" href="plc.c.html">plc.c</a>. The function is declared in <a class="reference external" href="plc.h.html">plc.h</a> and defined in file <a class="reference external" href="Traffic2.c.html">Traffic2.c</a>.</p>
<p>This function use <code class="docutils literal"><span class="pre">VS_SW_INFO</span></code> and <code class="docutils literal"><span class="pre">VS_NW_INFO</span></code> messages to discover powerline network topology then calls functions <a class="reference internal" href="#support-localtraffic1"><span class="std std-ref">LocalTraffic1</span></a> and <a class="reference internal" href="#support-localtraffic2"><span class="std std-ref">LocalTraffic2</span></a> to generate traffic between the local powerline device and each remote powerline device. Unlike function <a class="reference internal" href="#support-networktraffic2"><span class="std std-ref">NetworkTraffic2</span></a>, it does not generate traffic between remote devices.</p>
</div>
</div>
<div class="section" id="slac-functions-and-variables">
<span id="slac"></span><h2>SLAC Functions and Variables<a class="headerlink" href="#slac-functions-and-variables" title="Permalink to this headline">¶</a></h2>
<p>The functions described in this chapter implement SLAC protocol building blocks. Essentially, there is one function for each dataflow shown on the SLAC interface diagram. The implementations are not sophisticated. Customers must adapt them their own run-time environments.</p>
<p>To assist in adapting functions fo various environments, SLAC functions all accept three arguments. The first is a session variable that references information that supports a single PEV-EVSE SLAC interaction. The second is a <a class="reference internal" href="#support-ethernet"><span class="std std-ref">channel</span></a> variable that references information that supports ISO Layer 2 network communications. The third is a message variable that references an IEEE 802.3 frame buffer used to format, transmit, receive and interpret SLAC messages. Applications may create lists, stacks, queues or heaps of session variables to support multiple PEV-EVSE conversations. That has not been done here but may be done in the future.</p>
<p>PEV-HLE determines the application type and security type and stores them in the session variable before attempting a new SLAC session. PEV-HLE also generates and stores the run identifier in the session variable before attempting a new SLAC session. The run identifier is included in messages so that the EVSE-HLE can distinguish frames from different PEV-HLEs when transmitted in broadcast.</p>
<div class="section" id="the-session-variable">
<span id="session-variable"></span><h3>The Session Variable<a class="headerlink" href="#the-session-variable" title="Permalink to this headline">¶</a></h3>
<p>The session variable is a structure defined in <a class="reference external" href="None">slac.h</a>. It stores the information needed to manage a single SLAC protocol session between PEV-HLE and EVSE-HLE. It is necessary because there are cases where multiple PEV-HLE attempt to communicate with one EVSE-HLE or vice verse and each communication involves multiple steps and some steps will fail or be abandoned.</p>
<dl class="docutils">
<dt>session.RunID</dt>
<dd>A session identifier used to support multiple PEV-EVSE sessions.
The PEV-HLE defines a new value with each associateion attempt and broadcasts it to EVSE-HLE in <code class="docutils literal"><span class="pre">CM_SLAC_PARAM.REQ</span></code> <code class="docutils literal"><span class="pre">RunID</span></code>.
EVSE-HLE receive it and store it in their session variable.
Once association starts, subsequent messages, in both directions, include this identifier so that PEV-HLE and EVSE-HLE can detect and collate messages from the same conversation.</dd>
<dt>session.APPLICATION_TYPE</dt>
<dd>Indicates the context in which the SLAC process is being carried out.
Currently, the only context is PEV-EVSE association.
The PEV-HLE sends this value to the EVSE-HLE in EVSE-HLE in <code class="docutils literal"><span class="pre">CM_SLAC_PARAM.REQ</span></code> message <code class="docutils literal"><span class="pre">APPLICATION_TYPE</span></code> field.
EVSE-HLE receive it and store it in their session variable.</dd>
<dt>session.SECURITY_TYPE</dt>
<dd>Indicates that the sender prefers Secure SLAC for PEV-EVSE matching.
Currently, the only value used in SLAC demonstration software is <code class="docutils literal"><span class="pre">0</span></code> for &#8220;No Security&#8221;.
The PEV-HLE defines this value as <code class="docutils literal"><span class="pre">0</span></code> on startup and broadcasts it to EVSE-HLE in in <code class="docutils literal"><span class="pre">CM_SLAC_PARAM.REQ</span></code> message <code class="docutils literal"><span class="pre">SECURITY_TYPE</span></code> field.
EVSE-HLE receive it and store it in their session variable for later use when sending SLAC messages.</dd>
<dt>session.RESP_TYPE</dt>
<dd>The EVSE-HLE defines this value and sends it to the PEV-HLE in <code class="docutils literal"><span class="pre">CM_SLAC_PARAM.CNF</span></code> message <code class="docutils literal"><span class="pre">RESP_TYPE</span></code> field.
THe default is <code class="docutils literal"><span class="pre">0</span></code> but this can be changed using &#8220;response type =&#8221; in profile <code class="file docutils literal"><span class="pre">evse.ini</span></code>.</dd>
<dt>session.NUM_SOUNDS</dt>
<dd>The number of <code class="docutils literal"><span class="pre">CM_MNBC_SOUND.IND</span></code> messages that the PEV-HLE should send during sounding.
The EVSE-HLE defines this value and sends it to PEV-HLE in <code class="docutils literal"><span class="pre">CM_SLAC_PARAM.CNF</span></code> message <code class="docutils literal"><span class="pre">NUM_SOUNDS</span></code> field.
The default is <code class="docutils literal"><span class="pre">10</span></code> but this can be changed using &#8220;time to soundi =&#8221; in profile <code class="file docutils literal"><span class="pre">evse.ini</span></code>.</dd>
<dt>session.TIME_OUT</dt>
<dd>The total time allowed for all session sounding to complete.
Any msounds arriving after the timeout will be lost.
The time is expressed in 100 msec increments.
The EVSE-HLE defines this value and sends it to PEV_HLE in <code class="docutils literal"><span class="pre">CM_SLAC_PARAM.CNF</span></code>.
The default is <code class="docutils literal"><span class="pre">8</span></code> but this can be changed using &#8220;number of sounds =&#8221; in profile <code class="file docutils literal"><span class="pre">evse.ini</span></code>.</dd>
<dt>session.AAG []</dt>
<dd>The cumulative average attenuation across <code class="docutils literal"><span class="pre">58</span></code> groups of <code class="docutils literal"><span class="pre">16</span></code> carriers.
The EVSE-HLE computes these averages from multiple <code class="docutils literal"><span class="pre">CM_ATTEN_PROFILE.IND</span></code> and forwards them to PEV-HLE in <code class="docutils literal"><span class="pre">CM_ATTEN_CHAR.IND</span></code>.
PEV_HLE populates array from <code class="docutils literal"><span class="pre">CM_ATTEN_CHAR.IND</span></code> message <code class="docutils literal"><span class="pre">ACVarField.ATTEN_PROFILE.AAG</span></code> field and evaluates it by averaging all values in the array to determine the overall average attenuation.
If that values is less than or equal to session.limit then a match may be attempted.</dd>
<dt>session.NumGroups</dt>
<dd>The number of elements in array session.AAG.
This EVSE-HLE defines this number and sends it to PEV-HLE in <code class="docutils literal"><span class="pre">CM_ATTEN_CHAR.IND</span></code> <code class="docutils literal"><span class="pre">ACVarField.NumGroups</span></code>.
For practical purposes, this value of this variable is constant at <code class="docutils literal"><span class="pre">58</span></code>.</dd>
<dt>session.MSOUND_TARGET</dt>
<dd>MAC address of EVSE-HLE that will receive <code class="docutils literal"><span class="pre">CM_MNBC_SOUND.IND</span></code> messages.
The EVSE-HLE defines this address and broadcasts it to PEV-HLE in <code class="docutils literal"><span class="pre">CM_SLAC_PARAM.CNF</span></code> message <code class="docutils literal"><span class="pre">M-SOUND_TRAGET</span></code> field.
THe PEV-HLE stores this address in its session variable.
The default is <code class="docutils literal"><span class="pre">FF:FF:FF:FF:FF:FF</span></code> and remains constant.
This value is not used at this time.</dd>
<dt>session.FORWARDING_STA</dt>
<dd>MAC address of PEV-HLE to receive <code class="docutils literal"><span class="pre">CM_SLAC_PROFILE.IND</span></code> messages.
The EVSE-HLE defines this address and sends it to PEV-HLE in <code class="docutils literal"><span class="pre">CM_SLAC_PARAM.CNF</span></code> message <code class="docutils literal"><span class="pre">FORWARDING_STA</span></code> field.
THe PEV-HLE stores this address in its session variable.
The default is <code class="docutils literal"><span class="pre">FF:FF:FF:FF:FF:FF</span></code> and remains constant.
This value is ignored when RESP_TYPE=0.</dd>
<dt>session.PEV_ID</dt>
<dd>The vehicle identification number.
The PEV-HLE sends this value to the EVSE-HLE in <code class="docutils literal"><span class="pre">CM_SLAC_MATCH.REQ</span></code> <code class="docutils literal"><span class="pre">MatchVarField.PEV_ID</span></code> field.
The default is <code class="docutils literal"><span class="pre">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span></code> but is can be changed using &#8220;vehicle identifier =&#8221; in profile <code class="file docutils literal"><span class="pre">pev.ini</span></code>.
The MatchVarField portion of the message forms the transaction record and may be encrypted.</dd>
<dt>session.PEV_MAC</dt>
<dd>PEV-HLE MAC address.
The PEV-HLE sends this address to the EVSE-HLE in <code class="docutils literal"><span class="pre">CM_SLAC_MATCH.REQ</span></code> <code class="docutils literal"><span class="pre">MatchVarField.PEV_MAC</span></code> field.
The MatchVarField portion of the message forms the transaction record and may be encrypted.</dd>
<dt>session.EVSE_ID</dt>
<dd>The station identification number.
The EVSE-HLE sends this value to PEV-HLE in <code class="docutils literal"><span class="pre">CM_SLAC_MATCH.CNF</span></code> message <code class="docutils literal"><span class="pre">MatchVarField.EVSE_ID</span></code> field.
The default is <code class="docutils literal"><span class="pre">BBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBB</span></code> but is can be changed using &#8220;station identifier =&#8221; in profile <code class="file docutils literal"><span class="pre">evse.ini</span></code>.
The MatchVarField portion of the message forms the transaction record and may be encrypted.</dd>
<dt>session.EVSE_MAC</dt>
<dd>EVSE-HLE MAC address.
The EVSE-HLE sends this value to PEV-HLE in <code class="docutils literal"><span class="pre">CM_SLAC_MATCH.CNF</span></code> message <code class="docutils literal"><span class="pre">MatchVarField.EVSE_MAC</span></code> field.
The MatchVarField portion of the message forms the transaction record and may be encrypted.</dd>
<dt>session.NMK</dt>
<dd>The EVSE-PLC Network Membership Key.
The EVSE-HLE defines this value when the station powers on.
The EVSE-HLE sends the NMK to the PEV-HLE in <code class="docutils literal"><span class="pre">CM_SLAC_MATCH.CNF</span></code> message <code class="docutils literal"><span class="pre">MatchField.NMK</span></code> field.
The PEV-HLE uses this value to form a network with the EVSE-PLC during charging.
The MatchVarField portion of the message forms the transaction record and may be encrypted.
The default for PEV-HLE is <code class="docutils literal"><span class="pre">50D3E4933F855B7040784DF815AA8DB7</span></code>, which is the key derived from network password &#8220;HomePlugAV&#8221;, but that can be changed using &#8220;nwtwork membership key =&#8221; in profile <code class="file docutils literal"><span class="pre">pev.ini</span></code>.
The default for EVSE-HLE is <code class="docutils literal"><span class="pre">B59319D7E8157BA001B018669CCEE30D</span></code>, which is the key derived from network password &#8220;HomePlugAV0123&#8221;, but that can be changed using &#8220;nwtwork membership key =&#8221; in profile <code class="file docutils literal"><span class="pre">evse.ini</span></code>.</dd>
<dt>session.NID</dt>
<dd>The EVSE-PLC Network Identifier.
The EVSE-HLE defines this value when the station powers.
The EVSE-HLE sends the NID to the PEV-HLE in <code class="docutils literal"><span class="pre">CM_SLAC_MATCH.CNF</span></code> message <code class="docutils literal"><span class="pre">MatchField.NID</span></code> field.
The PEV-HLE uses this value to form a network with the EVSE-PLC during charging.
The MatchVarField portion of the message forms the transaction record and may be encrypted.
The default for PEV-HLE is <code class="docutils literal"><span class="pre">B0F2E695666B03</span></code>, which is the key derived from network password &#8220;HomePlugAV&#8221;, but that can be changed using &#8220;nwtwork membership key =&#8221; in profile <code class="file docutils literal"><span class="pre">pev.ini</span></code>.
The default for EVSE-HLE is <code class="docutils literal"><span class="pre">026BCBA5354E08</span></code>, which is the key derived from network password &#8220;HomePlugAV0123&#8221;, but that can be changed using &#8220;nwtwork membership key =&#8221; in profile <code class="file docutils literal"><span class="pre">evse.ini</span></code>.</dd>
<dt>session.RND</dt>
<dd>A random value.
PEV-HLE computes this value and sends it to EVSE-HLE in <code class="docutils literal"><span class="pre">CM_MNBC_SOUND.IND</span></code>.
This value is not used at this time.</dd>
<dt>session.original_nmk</dt>
<dd>The original PEV-PLC Network Membership Key.
This is the original NMK of the PEV-HLE.
The PEV-HLE preserves this value before, and restores it after, the charging cycle.
The Qualcomm Atheros PEV-HLE and EVSE-HLE demonstration software reads these values from profile <code class="file docutils literal"><span class="pre">pev.ini</span></code> and <code class="file docutils literal"><span class="pre">evse.ini</span></code>, respectively, by &#8220;network membership key =&#8221;.</dd>
<dt>session.original_nid</dt>
<dd>The PLC Network Identifier (NID).
PEV-PLC and EVSE-PLC will each have a different NID at the start of the SLAC process.
This value must be preserved before, and restored after, charging.
Once charging is complete, PEV-HLE and EVSE-HLE restore this value to their respective PLC using <code class="docutils literal"><span class="pre">CM_SET_KEY</span></code>.
In a real world implementation, PEV-HLE and EVSE-HLE would read this value from their repective PLC and save it in session.nmk and session.NMK.
The Qualcomm Atheros PEV-HLE and EVSE-HLE demonstration software reads these values from profile <code class="file docutils literal"><span class="pre">pev.ini</span></code> and <code class="file docutils literal"><span class="pre">evse.ini</span></code>, respectively, by &#8220;network identifier =&#8221;.</dd>
<dt>session.state</dt>
<dd>The current SLAC protocol session state. Qualcomm Atheros PEV-HLE and EVSE-HLE demonstration programs use this value to direct internal state transitions.
Values range from <code class="docutils literal"><span class="pre">0</span></code> through <code class="docutils literal"><span class="pre">3</span></code>.</dd>
<dt>session.sounds</dt>
<dd>The number of MSounds captured received by EVSE-HLE.
This value may be less that NUM_SOUNDS the requested by the EVSE_HLE due to network interruptions or EVSE-HLE overloading.
This is the denominator used when computing the average attenuation in array session.AAG.
The values is set by PEV_HLE from <code class="docutils literal"><span class="pre">CM_ATTEN_CHAR.IND</span></code> message <code class="docutils literal"><span class="pre">NUM_SOUNDS</span></code> field.</dd>
<dt>session.limit</dt>
<dd>The attenuation threshold.
If the average attenuation value in session.AAG exceeds this value the PEV-HLE will make no attempt to connect the PEV-PLC to the EVSE-PLC.
The default value is <code class="docutils literal"><span class="pre">10</span></code> but this can be re-defined in profile <code class="file docutils literal"><span class="pre">pev.ini</span></code> by &#8220;attenuation threshold =&#8221;.</dd>
<dt>session.pause</dt>
<dd>The time in milliseconds between MSounds.
Sounding too frequently does not allow enough time for the EVSE-PLC to sample and compute values.
Sounding too infrequently wastes time.
The maximum sample rate may be limited by the quality of the powerline media and traffic passwing through the EVSE-PLC.
The default is <code class="docutils literal"><span class="pre">10</span></code> but can be re-defined in profile <code class="file docutils literal"><span class="pre">pev.ini</span></code> by &#8220;msound pause =&#8221;.</dd>
<dt>session.chargetime</dt>
<dd>The time in milliseconds allowed for the charging cycle to complete.
The default is <code class="docutils literal"><span class="pre">10</span></code> but this can be changed using &#8220;charge time =&#8221; in profile <code class="file docutils literal"><span class="pre">pev.ini</span></code> and <code class="file docutils literal"><span class="pre">evse.ini</span></code>.
The charge time should be the same for PEV-HLE and EVSE-HLE when running long tests.</dd>
<dt>session.settletime</dt>
<dd>The time in milliseconds allowed for the charging cycle to complete.
The default is <code class="docutils literal"><span class="pre">10</span></code> but this can be changed using &#8220;settle time =&#8221; in profile <code class="file docutils literal"><span class="pre">pev.ini</span></code> and <code class="file docutils literal"><span class="pre">evse.ini</span></code>.
The settle time should be the same for PEV-HLE and EVSE-HLE when running long tests.</dd>
<dt>session.counter</dt>
<dd>The number of chaging session that have take place.
This variable is not part of the SLAC protocol.
The PEV-HLE and EVSE-HLE increment this counter each time they enter the &#8220;Charging&#8221; state and exchange this value in the unused <code class="docutils literal"><span class="pre">CM_SLAC_PARAM.REW</span></code> and <code class="docutils literal"><span class="pre">CM_SLAC_PARAM.CNF</span></code> message <code class="docutils literal"><span class="pre">CipherSuite</span></code> field.
Runtime options can be used to instruct either the PEV-HLE or EVSE-HLE to terminate if their counts are out-of-sync.</dd>
<dt>session.flags</dt>
<dd>A bit-mapped flagword used to control program flow based on user-specified command line options.</dd>
</dl>
</div>
<div class="section" id="pev-cm-slac-param">
<h3>pev_cm_slac_param<a class="headerlink" href="#pev-cm-slac-param" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="c.pev_cm_slac_param">
signed <code class="descname">pev_cm_slac_param</code><span class="sig-paren">(</span>struct session<em>&nbsp;*session</em>, struct channel<em>&nbsp;*channel</em>, struct message<em>&nbsp;*message</em><span class="sig-paren">)</span><a class="headerlink" href="#c.pev_cm_slac_param" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>PEV-HLE broadcasts <code class="docutils literal"><span class="pre">CM_SLAC_PARAM.REQ</span></code> messages and waits for a <code class="docutils literal"><span class="pre">CM_SLAC_PARAM.CNF</span></code> from EVSE-HLEs.
This is the first message sent and it initiates SLAC session one some EVSE-HLE responds.
Function pev_cm_slac_param copies session.APPLICATION_TYPE, session.SECURITY_TYPE and session.RunID into <code class="docutils literal"><span class="pre">CM_SLAC_PARAM.REQ</span></code> and broadcasts it to listening EVSE-HLE.</p>
<p>It is possible that multiple EVSE-HLEs will respond but one response is sufficient to proceed.
If a <code class="docutils literal"><span class="pre">CM_SLAC_PARAM.CNF</span></code> is not received within a reasonable time, PEV-HLE sends another another <code class="docutils literal"><span class="pre">CM_SLAC_PARAM.REQ</span></code> message.
PEV-HLE should compare the run identifier in the <code class="docutils literal"><span class="pre">CM_SLAC_PARAM.CNF</span></code> to that stored in the session variable to ensure that it is not processing <code class="docutils literal"><span class="pre">CM_SLAC_PARAM.CNF</span></code> messages from some other session.
PEV-HLE compares <code class="docutils literal"><span class="pre">RunID</span></code>, <code class="docutils literal"><span class="pre">APPLICATION_TYPE</span></code> and <code class="docutils literal"><span class="pre">SECURITY_TYPE</span></code> from <code class="docutils literal"><span class="pre">CM_SLAC_PARAM.CNF</span></code> to that stored in the session variable to ensure they have not changed.
PEV-HLE stores <code class="docutils literal"><span class="pre">MSOUND_TARGET</span></code>, <code class="docutils literal"><span class="pre">NUM_SOUNDS</span></code> and <code class="docutils literal"><span class="pre">TIME_OUT</span></code> in the session variable for later use.</p>
</div>
<div class="section" id="evse-cm-slac-param">
<h3>evse_cm_slac_param<a class="headerlink" href="#evse-cm-slac-param" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="c.evse_cm_slac_param">
signed <code class="descname">evse_cm_slac_param</code><span class="sig-paren">(</span>struct session<em>&nbsp;*session</em>, struct channel<em>&nbsp;*channel</em>, struct message<em>&nbsp;*message</em><span class="sig-paren">)</span><a class="headerlink" href="#c.evse_cm_slac_param" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>EVSE-HLE receives a <code class="docutils literal"><span class="pre">CM_SLAC_PARAM.REQ</span></code> and responds with a <code class="docutils literal"><span class="pre">CM_SLAC_PARAM.CNF</span></code> message.
This function waits indefinitly for <code class="docutils literal"><span class="pre">CM_SLAC_PARAM.REQ</span></code> then copies <code class="docutils literal"><span class="pre">RunID</span></code>, <code class="docutils literal"><span class="pre">APPLICATION_TYPE</span></code> and <code class="docutils literal"><span class="pre">SECURITY_TYPE</span></code> from <code class="docutils literal"><span class="pre">CM_SLAC_PARAM.REQ</span></code> to the session variable for later use.
It then copies session.MSOUND_TARGET, session.NUM_SOUNDS, session.TIME_OUT, session.RESP_TYPE, session.FORWARDING_STA, session.APPLICATION_TYPE, session.SECURITY_TYPE and session.RunID to <code class="docutils literal"><span class="pre">CM_SLAC_PARAM.CNF</span></code> and sends it unicast to the requesting PEV-HLE.</p>
</div>
<div class="section" id="pev-cm-start-atten-char">
<h3>pev_cm_start_atten_char<a class="headerlink" href="#pev-cm-start-atten-char" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="c.evse_cm_start_atten_char">
signed <code class="descname">evse_cm_start_atten_char</code><span class="sig-paren">(</span>struct session<em>&nbsp;*session</em>, struct channel<em>&nbsp;*channel</em>, struct message<em>&nbsp;*message</em><span class="sig-paren">)</span><a class="headerlink" href="#c.evse_cm_start_atten_char" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>PEV-HLE informs listening EVSE-HLE that sounding is about to start by broadcasting <code class="docutils literal"><span class="pre">CM_START_ATTEN_CHAR.IND</span></code>.
Function pev_cm_start_char copies session.NUM_SOUNDS, session.TIME_OUT, session.RESP_TYPE, session.FORWARDING_STA and session.RunID to <code class="docutils literal"><span class="pre">CM_START_ATTEN_CHAR.IND</span></code>.</p>
<p>The standard recommends that this message be sent three times. Our demonstration software does not do this.</p>
</div>
<div class="section" id="evse-cm-start-atten-char">
<h3>evse_cm_start_atten_char<a class="headerlink" href="#evse-cm-start-atten-char" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt>
signed <code class="descname">evse_cm_start_atten_char</code><span class="sig-paren">(</span>struct session<em>&nbsp;*session</em>, struct channel<em>&nbsp;*channel</em>, struct message<em>&nbsp;*message</em><span class="sig-paren">)</span></dt>
<dd></dd></dl>

<p>EVSE-HLE receives <code class="docutils literal"><span class="pre">CM_START_ATTEN_CHAR</span></code> from PEV-HLE and prepares to receive sounds by initializing msound counters and starting a timer.
This function compares <code class="docutils literal"><span class="pre">RunID</span></code> from <code class="docutils literal"><span class="pre">CM_START_ATTEN_CHAR</span></code> to session.RunID to ensure that this message belongs to a known session.
This function compares <code class="docutils literal"><span class="pre">APPLICATION_TYPE</span></code>, <code class="docutils literal"><span class="pre">SECURITY_TYPE</span></code>, <code class="docutils literal"><span class="pre">NUM_SOUNDS</span></code>, <code class="docutils literal"><span class="pre">TIME_OUT</span></code>, <code class="docutils literal"><span class="pre">RESP_TYPE</span></code> and <code class="docutils literal"><span class="pre">FORWARDING_STA</span></code> to the session variable to ensure that values have not changed.</p>
</div>
<div class="section" id="pev-cm-mnbc-sound">
<h3>pev_cm_mnbc_sound<a class="headerlink" href="#pev-cm-mnbc-sound" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="c.pev_cm_mnbc_sound">
signed <code class="descname">pev_cm_mnbc_sound</code><span class="sig-paren">(</span>struct session<em>&nbsp;*session</em>, struct channel<em>&nbsp;*channel</em>, struct message<em>&nbsp;*message</em><span class="sig-paren">)</span><a class="headerlink" href="#c.pev_cm_mnbc_sound" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>PEV-HLE sends periodic <code class="docutils literal"><span class="pre">CM_MNBC_SOUND.IND</span></code> to EVSE-HLE.</p>
</div>
<div class="section" id="evse-cm-mnbc-sound">
<h3>evse_cm_mnbc_sound<a class="headerlink" href="#evse-cm-mnbc-sound" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="c.evse_cm_mnbc_sound">
signed <code class="descname">evse_cm_mnbc_sound</code><span class="sig-paren">(</span>struct session<em>&nbsp;*session</em>, struct channel<em>&nbsp;*channel</em>, struct message<em>&nbsp;*message</em><span class="sig-paren">)</span><a class="headerlink" href="#c.evse_cm_mnbc_sound" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>EVSE-HLE receives interleaved <code class="docutils literal"><span class="pre">CM_MNBC_SOUND.IND</span></code> from PEV-HLE and <code class="docutils literal"><span class="pre">CM_ATTEN_PROFILE.IND</span></code> messages from EVSE-PLC.
This function maintains a running average of attenuation values across each carrier group in array session.AAG.</p>
</div>
<div class="section" id="evse-cm-atten-char">
<h3>evse_cm_atten_char<a class="headerlink" href="#evse-cm-atten-char" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="c.evse_cm_atten_char">
signed <code class="descname">evse_cm_atten_char</code><span class="sig-paren">(</span>struct session<em>&nbsp;*session</em>, struct channel<em>&nbsp;*channel</em>, struct message<em>&nbsp;*message</em><span class="sig-paren">)</span><a class="headerlink" href="#c.evse_cm_atten_char" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>EVSE-HLE sends <code class="docutils literal"><span class="pre">CM_ATTEN_CHAR.IND</span></code> to PEV-HLE.
This function copies session.AAG to <code class="docutils literal"><span class="pre">CM_ATTEN_CHAR.IND</span></code>.</p>
</div>
<div class="section" id="pev-cm-atten-char">
<h3>pev_cm_atten_char<a class="headerlink" href="#pev-cm-atten-char" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="c.pev_cm_atten_char">
signed <code class="descname">pev_cm_atten_char</code><span class="sig-paren">(</span>struct session<em>&nbsp;*session</em>, struct channel<em>&nbsp;*channel</em>, struct message<em>&nbsp;*message</em><span class="sig-paren">)</span><a class="headerlink" href="#c.pev_cm_atten_char" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>PEV-HLE receives <code class="docutils literal"><span class="pre">CM_ATTEN_CHAR.IND</span></code> from EVSE-HLE and acknwoledges with <code class="docutils literal"><span class="pre">CM_ATTEN_CHAR.RSP</span></code>.</p>
</div>
<div class="section" id="pev-cm-slac-match">
<h3>pev_cm_slac_match<a class="headerlink" href="#pev-cm-slac-match" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="c.pev_cm_slac_match">
signed <code class="descname">pev_cm_slac_match</code><span class="sig-paren">(</span>struct session<em>&nbsp;*session</em>, struct channel<em>&nbsp;*channel</em>, struct message<em>&nbsp;*message</em><span class="sig-paren">)</span><a class="headerlink" href="#c.pev_cm_slac_match" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>PEV-HLE sends <code class="docutils literal"><span class="pre">CM_SLAC_MATCH.REQ</span></code> to selected EVSE-HLE and waits for <code class="docutils literal"><span class="pre">CM_SLAC_MATCH.CNF</span></code>.
This function evaluates sounds across all carrier groups and compares result to some threshold and selects one EVSE-HLE.
This function copies session.APPLICAION_TYPE, session.SECURITY_TYPE, session.PEV_ID, session.PEV_MAC and session.RunID to <code class="docutils literal"><span class="pre">CM_SLAC_PARAM.REQ</span></code> and sends it unicast to the selected EVSE-HLE.</p>
</div>
<div class="section" id="evse-cm-slac-match">
<h3>evse_cm_slac_match<a class="headerlink" href="#evse-cm-slac-match" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="c.evse_cm_slac_match">
signed <code class="descname">evse_cm_slac_match</code><span class="sig-paren">(</span>struct session<em>&nbsp;*session</em>, struct channel<em>&nbsp;*channel</em>, struct message<em>&nbsp;*message</em><span class="sig-paren">)</span><a class="headerlink" href="#c.evse_cm_slac_match" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>EVSE-HLE listens for <code class="docutils literal"><span class="pre">CM_SLAC_MATCH.REQ</span></code> from PEV-HLE and abandons the session if no indication is received within a reasonable time.
If an indication is received then this function compares <code class="docutils literal"><span class="pre">RunID</span></code> from <code class="docutils literal"><span class="pre">CM_SLAC_MATCH.REQ</span></code> to the session.RunID to ensure the message is part of the current session.
This function compares <code class="docutils literal"><span class="pre">APPLICATION_TYPE</span></code> and <code class="docutils literal"><span class="pre">SECURITY_TYPE</span></code> to the session.APPLICATION_TYPE and session.SECURITY_TYPE to ensure that they have not changed.
This function copies <code class="docutils literal"><span class="pre">PEV_ID</span></code> and <code class="docutils literal"><span class="pre">PEV_MAC</span></code> from <code class="docutils literal"><span class="pre">CM_SLAC_MATCH.REQ</span></code> to the session variable for later use.
This function updates session.NMK and session.NID with random values.
This function copies session.EVSE_ID, session.EVSE_MAC, session.NMK and session.NID to <code class="docutils literal"><span class="pre">CM_SLAC_MATCH.RSP</span></code> and sends it unicast to the selecing PEV-HLE.</p>
</div>
<div class="section" id="evse-cm-set-key">
<h3>evse_cm_set_key<a class="headerlink" href="#evse-cm-set-key" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt>
signed <code class="descname">evse_cm_mnbc_sound</code><span class="sig-paren">(</span>struct session<em>&nbsp;*session</em>, struct channel<em>&nbsp;*channel</em>, struct message<em>&nbsp;*message</em><span class="sig-paren">)</span></dt>
<dd></dd></dl>

</div>
<div class="section" id="pev-cm-set-key">
<h3>pev_cm_set_key<a class="headerlink" href="#pev-cm-set-key" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt>
signed <code class="descname">pev_cm_mnbc_sound</code><span class="sig-paren">(</span>struct session<em>&nbsp;*session</em>, struct channel<em>&nbsp;*channel</em>, struct message<em>&nbsp;*message</em><span class="sig-paren">)</span></dt>
<dd></dd></dl>

</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="open-plc-utils.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Support Function Reference</a><ul>
<li><a class="reference internal" href="#introduction">Introduction</a></li>
<li><a class="reference internal" href="#command-line-functions">Command Line Functions</a><ul>
<li><a class="reference internal" href="#assist">assist</a></li>
<li><a class="reference internal" href="#basespec">basespec</a></li>
<li><a class="reference internal" href="#bytespec">bytespec</a></li>
<li><a class="reference internal" href="#checkfilename">checkfilename</a></li>
<li><a class="reference internal" href="#dataspec">dataspec</a></li>
<li><a class="reference internal" href="#error">error</a></li>
<li><a class="reference internal" href="#expect">expect</a></li>
<li><a class="reference internal" href="#getoptv">getoptv</a></li>
<li><a class="reference internal" href="#ipv4spec">ipv4spec</a></li>
<li><a class="reference internal" href="#ipv6spec">ipv6spec</a></li>
<li><a class="reference internal" href="#lookup">lookup</a></li>
<li><a class="reference internal" href="#putoptv">putoptv</a></li>
<li><a class="reference internal" href="#synonym">synonym</a></li>
<li><a class="reference internal" href="#uintspec">uintspec</a></li>
<li><a class="reference internal" href="#version">version</a></li>
</ul>
</li>
<li><a class="reference internal" href="#ethernet-functions">Ethernet Functions</a><ul>
<li><a class="reference internal" href="#channel">channel</a></li>
<li><a class="reference internal" href="#closechannel">closechannel</a></li>
<li><a class="reference internal" href="#openchannel">openchannel</a></li>
<li><a class="reference internal" href="#readpacket">readpacket</a></li>
<li><a class="reference internal" href="#sendpacket">sendpacket</a></li>
</ul>
</li>
<li><a class="reference internal" href="#network-functions">Network Functions</a><ul>
<li><a class="reference internal" href="#networkbridges">NetworkBridges</a><ul>
<li><a class="reference internal" href="#enumerating-local-devices">Enumerating Local Devices</a></li>
</ul>
</li>
<li><a class="reference internal" href="#networkdevices">NetworkDevices</a><ul>
<li><a class="reference internal" href="#enumerating-network-devices">Enumerating Network Devices</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#generic-functions">Generic Functions</a><ul>
<li><a class="reference internal" href="#binout">binout</a></li>
<li><a class="reference internal" href="#checksum32">checksum32</a></li>
<li><a class="reference internal" href="#checksum-32">checksum_32</a></li>
<li><a class="reference internal" href="#chrout">chrout</a></li>
<li><a class="reference internal" href="#decout">decout</a></li>
<li><a class="reference internal" href="#endian">endian</a></li>
<li><a class="reference internal" href="#fdchecksum32">fdchecksum32</a></li>
<li><a class="reference internal" href="#fdchecksum-32">fdchecksum_32</a></li>
<li><a class="reference internal" href="#filepart">filepart</a></li>
<li><a class="reference internal" href="#hexdecode">hexdecode</a></li>
<li><a class="reference internal" href="#hexdump">hexdump</a></li>
<li><a class="reference internal" href="#hexencode">hexencode</a></li>
<li><a class="reference internal" href="#hexin">hexin</a></li>
<li><a class="reference internal" href="#hexout">hexout</a></li>
<li><a class="reference internal" href="#hexstring">hexstring</a></li>
<li><a class="reference internal" href="#hexview">hexview</a></li>
<li><a class="reference internal" href="#memdecr">memdecr</a></li>
<li><a class="reference internal" href="#memincr">memincr</a></li>
<li><a class="reference internal" href="#memout">memout</a></li>
<li><a class="reference internal" href="#memswap">memswap</a></li>
<li><a class="reference internal" href="#strdecr">strdecr</a></li>
<li><a class="reference internal" href="#strfbits">strfbits</a></li>
<li><a class="reference internal" href="#strincr">strincr</a></li>
<li><a class="reference internal" href="#todigit">todigit</a></li>
<li><a class="reference internal" href="#typename">typename</a></li>
</ul>
</li>
<li><a class="reference internal" href="#message-debug-functions">Message Debug Functions</a><ul>
<li><a class="reference internal" href="#mmecode">MMECode</a></li>
<li><a class="reference internal" href="#mmemode">MMEMode</a></li>
<li><a class="reference internal" href="#mmename">MMEName</a></li>
<li><a class="reference internal" href="#mmepeek">MMEPeek</a></li>
</ul>
</li>
<li><a class="reference internal" href="#key-generation-functions">Key Generation Functions</a><ul>
<li><a class="reference internal" href="#sha256-digest-computation">SHA256 Digest Computation</a></li>
<li><a class="reference internal" href="#macpasswords">MACPasswords</a></li>
<li><a class="reference internal" href="#hpavkeydak">HPAVKeyDAK</a></li>
<li><a class="reference internal" href="#hpavkeynmk">HPAVKeyNMK</a></li>
<li><a class="reference internal" href="#hpavkeynid">HPAVKeyNID</a></li>
<li><a class="reference internal" href="#hpavkeyout">HPAVKeyOut</a></li>
<li><a class="reference internal" href="#sha256block">SHA256Block</a></li>
<li><a class="reference internal" href="#sha256fetch">SHA256Fetch</a></li>
<li><a class="reference internal" href="#sha256ident">SHA256Ident</a></li>
<li><a class="reference internal" href="#sha256match">SHA256Match</a></li>
<li><a class="reference internal" href="#sha256print">SHA256Print</a></li>
<li><a class="reference internal" href="#sha256reset">SHA256Reset</a></li>
<li><a class="reference internal" href="#sha256write">SHA256Write</a></li>
</ul>
</li>
<li><a class="reference internal" href="#xml-editing-functions">XML Editing Functions</a><ul>
<li><a class="reference internal" href="#xmledit">xmledit</a></li>
<li><a class="reference internal" href="#xmlfree">xmlfree</a></li>
<li><a class="reference internal" href="#xmlnode">xmlnode</a></li>
<li><a class="reference internal" href="#xmlopen">xmlopen</a></li>
<li><a class="reference internal" href="#xmlscan">xmlscan</a><ul>
<li><a class="reference internal" href="#xml-source-file">XML Source File</a></li>
</ul>
</li>
<li><a class="reference internal" href="#xmlschema">xmlschema</a><ul>
<li><a class="reference internal" href="#xml-edit-schema">XML Edit Schema</a></li>
</ul>
</li>
<li><a class="reference internal" href="#xmltree">xmltree</a><ul>
<li><a class="reference internal" href="#xml-parse-tree">XML Parse Tree</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#download-functions">Download Functions</a><ul>
<li><a class="reference internal" href="#writeexecuteapplet">WriteExecuteApplet</a></li>
<li><a class="reference internal" href="#writeexecuteapplet1">WriteExecuteApplet1</a></li>
<li><a class="reference internal" href="#writeexecuteapplet2">WriteExecuteApplet2</a></li>
</ul>
</li>
<li><a class="reference internal" href="#procrastination-functions">Procrastination Functions</a><ul>
<li><a class="reference internal" href="#waitforassoc">WaitForAssoc</a></li>
<li><a class="reference internal" href="#waitforassoc1">WaitForAssoc1</a></li>
<li><a class="reference internal" href="#waitforassoc2">WaitForAssoc2</a></li>
<li><a class="reference internal" href="#waitforreset">WaitForReset</a></li>
<li><a class="reference internal" href="#waitforstart">WaitForStart</a></li>
</ul>
</li>
<li><a class="reference internal" href="#traffic-functions">Traffic Functions</a><ul>
<li><a class="reference internal" href="#crosstraffic1">CrossTraffic1</a></li>
<li><a class="reference internal" href="#crosstraffic2">CrossTraffic2</a></li>
<li><a class="reference internal" href="#localtraffic1">LocalTraffic1</a></li>
<li><a class="reference internal" href="#localtraffic2">LocalTraffic2</a></li>
<li><a class="reference internal" href="#networktraffic1">NetworkTraffic1</a></li>
<li><a class="reference internal" href="#networktraffic2">NetworkTraffic2</a></li>
<li><a class="reference internal" href="#traffic1">Traffic1</a></li>
<li><a class="reference internal" href="#traffic2">Traffic2</a></li>
</ul>
</li>
<li><a class="reference internal" href="#slac-functions-and-variables">SLAC Functions and Variables</a><ul>
<li><a class="reference internal" href="#the-session-variable">The Session Variable</a></li>
<li><a class="reference internal" href="#pev-cm-slac-param">pev_cm_slac_param</a></li>
<li><a class="reference internal" href="#evse-cm-slac-param">evse_cm_slac_param</a></li>
<li><a class="reference internal" href="#pev-cm-start-atten-char">pev_cm_start_atten_char</a></li>
<li><a class="reference internal" href="#evse-cm-start-atten-char">evse_cm_start_atten_char</a></li>
<li><a class="reference internal" href="#pev-cm-mnbc-sound">pev_cm_mnbc_sound</a></li>
<li><a class="reference internal" href="#evse-cm-mnbc-sound">evse_cm_mnbc_sound</a></li>
<li><a class="reference internal" href="#evse-cm-atten-char">evse_cm_atten_char</a></li>
<li><a class="reference internal" href="#pev-cm-atten-char">pev_cm_atten_char</a></li>
<li><a class="reference internal" href="#pev-cm-slac-match">pev_cm_slac_match</a></li>
<li><a class="reference internal" href="#evse-cm-slac-match">evse_cm_slac_match</a></li>
<li><a class="reference internal" href="#evse-cm-set-key">evse_cm_set_key</a></li>
<li><a class="reference internal" href="#pev-cm-set-key">pev_cm_set_key</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="scripting.html"
                        title="previous chapter">Scripting</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="drivers.html"
                        title="next chapter">Serial Drivers</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/support.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="drivers.html" title="Serial Drivers"
             >next</a> |</li>
        <li class="right" >
          <a href="scripting.html" title="Scripting"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="open-plc-utils.html">open-plc-utils 0.0.4 documentation</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2015, open-plc-utils developers.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.4.8.
    </div>
  </body>
</html>